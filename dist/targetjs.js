/*! For license information please see targetjs.js.LICENSE.txt */
!function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return l=t.done,t},e:function(t){s=!0,o=t},f:function(){try{l||null==n.return||n.return()}finally{if(s)throw o}}}}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}t.r(e),t.d(e,{$Dom:function(){return d},App:function(){return $e},Bracket:function(){return $t},BracketGenerator:function(){return Qt},ColorUtil:function(){return X},Easing:function(){return D},Moves:function(){return cn},SearchUtil:function(){return ct},TModel:function(){return mt},TModelUtil:function(){return q},TUtil:function(){return s},TargetData:function(){return M},TargetExecutor:function(){return H},TargetUtil:function(){return p},fetch:function(){return Ze},fetchImage:function(){return Ge},getBrowser:function(){return en},getEvents:function(){return qe},getLoader:function(){return Ke},getLocationManager:function(){return tn},getManager:function(){return Qe},getPager:function(){return ze},getResizeLastUpdate:function(){return on},getRunScheduler:function(){return Je},getScreenHeight:function(){return rn},getScreenWidth:function(){return nn},getVisibles:function(){return an},isRunning:function(){return We},tApp:function(){return Fe},tRoot:function(){return _e}});var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e=t,l=[{key:"calcVisibility",value:function(e){var n=e.absX,r=e.absY,i=e.getDomParent(),a=e.getRealParent(),o=(i.getMeasuringScale()||1)*e.getMeasuringScale(),l=t.isDefined(e.getWidth())?o*e.getWidth():0,s=t.isDefined(e.getHeight())?o*e.getHeight():0;e.visibilityStatus||(e.visibilityStatus={});var u=e.visibilityStatus,c=e.validateVisibilityInParent()?Math.max(i.absX,a.absX):0,h=e.validateVisibilityInParent()?Math.max(i.absY,a.absY):0,d=e.validateVisibilityInParent()?Math.min(i.getWidth(),a.getWidth()):nn(),f=e.validateVisibilityInParent()?Math.min(i.getHeight(),a.getHeight()):rn();return u.right=n<=c+d,u.left=n+l>=c,u.bottom=r-e.getTopMargin()<=h+f,u.top=r+s>=h,u.parentX=c,u.parentY=h,u.parentWidth=d,u.parentHeight=f,e.val("isVisible",u.left&&u.right&&u.top&&u.bottom),e.val("isVisible")}},{key:"initDoms",value:function(e){var n=d.getAllStamped();e.forEach((function(t){t.$dom=null}));var i,a=t.list2map(e.filter((function(t){return"BI"!==t.type}))),o=r(n);try{for(o.s();!(i=o.n()).done;){var l=i.value,s=l.getAttribute("id"),u=a[s];u?u.$dom=new d("#".concat(s)):d.detach(l)}}catch(t){o.e(t)}finally{o.f()}}},{key:"contains",value:function(t,e){var n;return!(!t||!e||t!==e&&e.getDomParent()!==t&&(null===(n=e.getDomParent())||void 0===n?void 0:n.getDomParent())!==t)}},{key:"list2map",value:function(e,n){return e.reduce((function(e,r){return e[r.oid]=t.isDefined(n)?n:r,e}),{})}},{key:"getDeepList",value:function(t){var e=[];return function t(n){if(n&&n.hasChildren()){var r=n.getChildren();e.push.apply(e,function(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r)),r.forEach(t)}}(t),e}},{key:"areEqual",value:function(t,e,n){return n?JSON.stringify(t)===JSON.stringify(e):t===e}},{key:"momentum",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.002,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,a=e-t,o=n<10?Math.abs(a)/10:Math.abs(a)/n,l=o/r,s=Math.pow(o,2)/(2*r);s>i&&(s=i);var u=a>0?a+s:a-s;return{distance:Math.round(u)/5,duration:Math.round(l),momentumDistance:s}}},{key:"isDefined",value:function(t){return null!=t}},{key:"isNumber",value:function(t){return"number"==typeof t&&!isNaN(t)}},{key:"limit",value:function(e,n,r){return(e=(e=t.isDefined(e)?e:n)>r?r:e)<n?n:e}},{key:"capitalizeFirstLetter",value:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},{key:"formatNum",value:function(t,e){return t?parseFloat(t.toString()).toFixed(e):0}},{key:"now",value:function(){return Date.now()}},{key:"log",value:function(t){return!0===t?console.log:function(){}}},{key:"distance",value:function(t,e,n,r){return Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2))}},{key:"getFullLink",value:function(e){if(t.isDefined(e)){if(!e.startsWith("http")){var n=window.location.protocol;n+=n.endsWith(":")?"//":"://";var r="".concat(n).concat(window.location.hostname);e=e.startsWith("/")?r+e:"".concat(r,"/").concat(e)}return e.endsWith("/")?e.slice(0,-1):e}}},{key:"isStringBooleanOrNumber",value:function(t){var e=n(t);return"string"===e||"boolean"===e||"number"===e}},{key:"logTree",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=r(tn().getChildren(n));try{for(a.s();!(e=a.n()).done;){var o=e.value,l=o.isVisible()?i+"|  ":i+"x  ";"BI"===o.type?console.log("".concat(l).concat(o.oid," v:").concat(o.isVisible()," x:").concat(Math.floor(o.getX())," y:").concat(Math.floor(o.getY()),", absY:").concat(Math.floor(o.absY)," yy:").concat(Math.floor(o.absY+o.getDomParent().absY)," w:").concat(Math.floor(o.getWidth())," h:").concat(Math.floor(o.getHeight())," hc:").concat(Math.floor(o.getContentHeight()))):console.log("".concat(l).concat(o.oid," v:").concat(o.isVisible()," x:").concat(Math.floor(o.getX())," y:").concat(Math.floor(o.getY())," absY:").concat(Math.floor(o.absY)," yy:").concat(Math.floor(o.absY+o.getDomParent().absY)," w:").concat(Math.floor(o.getWidth())," h:").concat(Math.floor(o.getHeight())," hc:").concat(Math.floor(o.getContentHeight()))),o.hasChildren()&&t.logTree(o,l)}}catch(t){a.e(t)}finally{a.f()}}}],null&&o(e.prototype,null),l&&o(e,l),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,l}();function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function h(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.selector=e,this.element=t.query(e)):e&&(this.element=e),this.childrenCount=0,this.$domParent=void 0,this.originalContent=void 0,this.textOnly=!0}return e=t,n=[{key:"cloneTemplate",value:function(){var e;return new t(null===(e=this.element.content)||void 0===e?void 0:e.cloneNode(!0).children[0])}},{key:"exists",value:function(){return this.selector&&(this.element=t.query(this.selector)),!!this.element}},{key:"contains",value:function(t){return t instanceof Node&&this.element.contains(t)}},{key:"create",value:function(t){this.element=document.createElement(t)}},{key:"getTagName",value:function(){return this.element.tagName.toLowerCase()}},{key:"setSelector",value:function(t){this.selector=t}},{key:"setId",value:function(t){this.attr("id","#"===t[0]?t.slice(1):t)}},{key:"focus",value:function(){this.element.focus()}},{key:"blur",value:function(){this.element.blur()}},{key:"attr",value:function(t,e){if(this.element)return s.isDefined(e)?void this.element.setAttribute(t,e):this.element.getAttribute(t)}},{key:"value",value:function(t){if(this.element){var e=this.element.value;return s.isDefined(t)&&(this.element.value=t),e}}},{key:"select",value:function(){this.element&&"function"==typeof this.element.select&&this.element.select()}},{key:"width",value:function(t){if(!s.isDefined(t))return this.element.offsetWidth;this.element.style.width=s.isNumber(t)?"".concat(t,"px"):t}},{key:"height",value:function(t){if(!s.isDefined(t))return this.element.offsetHeight;this.element.style.height=s.isNumber(t)?"".concat(t,"px"):t}},{key:"css",value:function(t){if(!s.isDefined(t))return this.element.className;this.element.className=t}},{key:"setStyleByMap",value:function(t){var e=this;Object.keys(t).forEach((function(n){e.style(n,t[n])}))}},{key:"style",value:function(t,e){if(2!==arguments.length)return 1===arguments.length?this.element.style[t]:this.element.style;this.element.style[t]=e}},{key:"getStyleValue",value:function(t){var e=this.style(t),n=s.isDefined(e)?e.replace(/[^-\d.]/g,""):0;return parseFloat(n)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"isXYWithinElement",value:function(t,e){var n=this.getBoundingClientRect();return t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}},{key:"parent",value:function(){return this.element?this.element.parentElement:null}},{key:"detach",value:function(){t.detach(this.element),this.$domParent&&this.$domParent.childrenCount>0&&this.$domParent.childrenCount--}},{key:"child",value:function(t){return this.element.children[t]}},{key:"append$Dom",value:function(t){this.element.appendChild(t.element)}},{key:"appendElement",value:function(t){this.element.appendChild(t)}},{key:"removeElement",value:function(t){this.element.removeChild(t)}},{key:"elementCount",value:function(){return this.element.children.length}},{key:"swapElements",value:function(t,e){var n=e.nextSibling;n===t?this.element.insertBefore(t,e):(this.element.insertBefore(e,t),this.element.insertBefore(t,n))}},{key:"insertFirst$Dom",value:function(t){this.element.firstChild?this.element.insertBefore(t.element,this.element.firstChild):this.append$Dom(t)}},{key:"relocate",value:function(t,e){this.element.insertBefore(t.$dom.element,this.element.children[e])}},{key:"appendTModel$Dom",value:function(t){0===this.childrenCount&&this.element.children.length>1&&t.getDomParent()&&t.getDomParent().getHtml()&&t.getDomParent().getHtml()===this.originalContent&&(this.element.innerHTML="<div>".concat(this.html(),"</div>")),this.element.appendChild(t.$dom.element),t.$dom.$domParent=this,this.childrenCount++}},{key:"deleteAll",value:function(){this.element.innerHTML=this.originalContent||"",this.childrenCount=0}},{key:"html",value:function(t){if(!s.isDefined(t))return s.isDefined(this.originalContent)?this.originalContent:this.element.innerHTML;if(this.childrenCount>0){var e=document.createElement("div");e.innerHTML=t,s.isDefined(this.originalContent)?this.element.replaceChild(e,this.element.firstChild):this.element.insertBefore(e,this.element.firstChild),this.originalContent=t,this.textOnly=!1}else this.element.innerHTML=t,this.originalContent=t,this.textOnly=!1}},{key:"text",value:function(t){if(!s.isDefined(t))return s.isDefined(this.originalContent)?this.originalContent:this.element.textContent;if(this.childrenCount>0){var e=document.createTextNode(t);s.isDefined(this.originalContent)?this.element.replaceChild(e,this.element.firstChild):this.element.insertBefore(e,this.element.firstChild),this.originalContent=t,this.textOnly=!0}else this.element.textContent=t,this.originalContent=t,this.textOnly=!0}},{key:"outerHTML",value:function(t){this.element.outerHTML=t}},{key:"isEmpty",value:function(){return""===this.element.innerHTML}},{key:"innerHTML",value:function(t){if(!s.isDefined(t))return this.element.innerHTML;this.element.innerHTML=t}},{key:"innerText",value:function(t){if(!s.isDefined(t))return this.element.innerText;this.element.innerText=t}},{key:"addClass",value:function(t){var e=this.attr("class"),n=e?e.includes(t)?e:"".concat(e," ").concat(t):t;n!==e&&this.attr("class",n)}},{key:"addEvent",value:function(t,e){this.element.addEventListener?this.element.addEventListener(t,e,{capture:!1,passive:!1}):this.element.attachEvent("on".concat(t),e)}},{key:"detachEvent",value:function(t,e){this.element.removeEventListener?this.element.removeEventListener(t,e,!1):this.element.detachEvent?this.element.detachEvent("on".concat(t),e):this.element["on".concat(t)]=null}},{key:"transform",value:function(t){this.element.style[en().style.transform]=t}},{key:"animate",value:function(t,e){return this.element.animate(t,e)}},{key:"getContext",value:function(e,n){var r=s.isDefined(n)?t.query(n):this.query("canvas");return r?r.getContext(e):void 0}},{key:"query",value:function(t){return this.element.querySelector(t)}},{key:"queryAll",value:function(t){return this.element.querySelectorAll(t)}},{key:"findFirstByClass",value:function(e){return t.findFirstByClass(e,this.element)}},{key:"findFirstByTag",value:function(e){return t.findFirstByTag(e,this.element)}},{key:"stamp",value:function(){this.attr("data-tgjs","true")}}],r=[{key:"createTemplate",value:function(e){var n=new t;return n.create("template"),n.innerHTML(e.trim()),n}},{key:"getAllStamped",value:function(){return document.querySelectorAll('[data-tgjs="true"]')}},{key:"query",value:function(e){return"#"===e[0]?t.findById(e):"."===e[0]?t.findFirstByClass(e):t.findFirstByTag(e)}},{key:"findById",value:function(t){return document.getElementById("#"===t[0]?t.slice(1):t)}},{key:"findFirstByClass",value:function(e,n){var r=t.findByClass(e,n);return r.length>0?r[0]:null}},{key:"findFirstByTag",value:function(e,n){var r=t.findByTag(e,n);return r.length>0?r[0]:null}},{key:"findByTag",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).getElementsByTagName(t)}},{key:"findByClass",value:function(t){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).getElementsByClassName("."===t[0]?t.slice(1):t)}},{key:"findNearestParentWithId",value:function(t){for(;t;){var e="function"==typeof t.getAttribute&&t.getAttribute("id")?t.getAttribute("id"):null;if(e&&Qe().visibleOidMap[e])return e;t=t.parentElement}}},{key:"detach",value:function(t){var e=s.isDefined(t)?t.parentElement:null;e&&e.removeChild(t)}},{key:"hasFocus",value:function(t){return t.hasDom()&&document.activeElement===t.$dom.element}},{key:"getWindowScrollTop",value:function(){return window.pageYOffset||document.documentElement.scrollTop||0}},{key:"getWindowScrollLeft",value:function(){return window.pageXOffset||document.documentElement.scrollLeft||0}},{key:"getScreenWidth",value:function(){return document.documentElement.clientWidth||document.body.clientWidth}},{key:"getScreenHeight",value:function(){return document.documentElement.clientHeight||document.body.clientHeight}},{key:"ready",value:function(e){new t(document).addEvent("DOMContentLoaded",e)}},{key:"ajax",value:function(t){var e=new XMLHttpRequest,n="";t.data&&(n=Object.keys(t.data).map((function(e){return"".concat(e,"=").concat(encodeURIComponent(t.data[e]))})).join("&")),e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status){var n="json"===t.dataType?JSON.parse(this.responseText):this.responseText;t.success(n)}else t.error(e.status)},"POST"===t.type?(e.open(t.type,t.url,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send(n)):(t.url+=n?t.url>""&&t.url.indexOf("?")>=0?"&".concat(n):"?".concat(n):"",e.open(t.type,t.url,!0),e.send())}}],n&&c(e.prototype,n),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function y(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}var g,p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e=t,n=[{key:"emptyValue",value:function(){return{value:void 0,step:0,steps:0,cycle:0,cycles:0,interval:0,initialValue:void 0,scheduleTimeStamp:void 0,actualValueLastUpdate:0,status:"",executionCount:0,executionFlag:!1,isImperative:!1,originalTargetName:void 0,easing:void 0,creationTime:s.now()}}},{key:"getTargetName",value:function(t){if(!t)return t;var e=t.startsWith("_")?t.slice(1):t;return e.endsWith("$$")?e.slice(0,-2):e.endsWith("$")?e.slice(0,-1):e}},{key:"bindTarget",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.keys(e.targets),i=e.targets[n],a=r.indexOf(n),o=a>0?t.getTargetName(r[a-1]):void 0,l=a<r.length-1?r[a+1]:void 0,s=function(){if(o)return Ke().isLoading(e,o)?Ke().getLoadingItemValue(e,o):e.val(o)},u=void 0!==o?e.getActualValueLastUpdate(o):void 0,c=function(){return void 0!==o?e.getActualValueLastUpdate(o):void 0},h=function(){var t=c();return(void 0!==u||void 0!==t)&&(void 0===u&&void 0!==t||t!==u)},d=!(!l||!l.endsWith("$"));i.originalTargetName=t.currentTargetName,i.originalTModel=t.currentTModel;var f=t.getTargetName(n),v=function(){return e.val(f)};d&&!i.activateNextTarget&&(i.activateNextTarget=l.slice(0,-1));var y=/^on[A-Za-z]+Step$/,g=/^on[A-Za-z]+End$/,p=["value","enabledOn","onStepsEnd","onValueChange","loop","onImperativeEnd","onImperativeStep","onSuccess","onError"];Object.keys(i).forEach((function(n){if("value"===n){var r=i[n];i[n]=function(){var n;t.currentTargetName=f,t.currentTModel=e,this.key=f,this.value=v(),this.prevTargetValue=s(),this.isPrevTargetUpdated=h;var i="function"==typeof r?r.apply(this,arguments):r;return u=null!==(n=c())&&void 0!==n?n:u,i}}else if("function"==typeof i[n]&&(p.includes(n)||y.test(n)||g.test(n))){var a=i[n];i[n]=function(){var n;t.currentTargetName=f,t.currentTModel=e,this.key=f,this.value=v(),this.prevTargetValue=s(),this.isPrevTargetUpdated=h;var r="function"==typeof a?a.apply(this,arguments):a;return u=null!==(n=c())&&void 0!==n?n:u,r}}}))}},{key:"shouldActivateNextTarget",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e.targets[n],a=null==i?void 0:i.activateNextTarget,o=t.getTargetName(a),l=null==a?void 0:a.endsWith("$"),s=null==i?void 0:i.fetchAction,u=null==i?void 0:i.childAction;if(s)if("onEnd"===s&&t.hasTargetEnded(e,n))t.activateNextTarget(e,o);else if("onEach"===s)for(;Ke().isNextLoadingItemSuccessful(e,n);)e.activatedTargets.indexOf(o)>=0?e.activatedTargets.push(o):t.activateNextTarget(e,o),Ke().nextActiveItem(e,n);else"inactive"===s&&t.hasTargetEnded(e,n)&&Ke().removeFromTModelKeyMap(e,n);else if(u)("onEnd"===u&&t.hasTargetEnded(e,n)||"onEach"===u)&&(t.activateNextTarget(e,o),i.childAction="inactive");else if(i&&o&&!e.isTargetImperative(n))(l&&t.hasTargetEnded(e,n)||!l)&&t.activateNextTarget(e,o);else{var c=e.isTargetImperative(n)?e.targetValues[n]:i,h=c.originalTModel,d=c.originalTargetName;r<2&&d&&h&&t.hasTargetEnded(h,d)&&t.shouldActivateNextTarget(h,d,r+1)}}},{key:"hasTargetEnded",value:function(t,e){if(!(t.isTargetComplete(e)||t.isTargetDone(e)||t.isActivated())||t.hasUpdatingTargets(e))return!1;var n=t.targets[e];if(n){if(n.childAction&&(t.hasUpdatingChildren()||t.hasActiveChildren()))return!1;if(n.fetchAction&&!Ke().isLoadingSuccessful(t,e))return!1}return!0}},{key:"activateNextTarget",value:function(t,e){t.targetValues[e]&&(t.targetValues[e].isImperative=!1),t.activeTargetMap[e]||t.activate(e)}},{key:"activateSingleTarget",value:function(t,e){t.targets[e]&&t.canTargetBeActivated(e)&&(t.isTargetEnabled(e)?t.activateTarget(e):t.addToActiveTargets(e))}},{key:"markTargetAction",value:function(e,n){if(e){var r=e.targets[t.currentTargetName];if("object"===f(r)){var i=r.activateNextTarget;null!=i&&i.endsWith("$")?r[n]="onEnd":r[n]=i?"onEach":"inactive"}}}},{key:"isValueStepsCycleArray",value:function(e){if(e.length>4||0===e.length)return!1;for(var n=1;n<e.length;n++)if("number"!=typeof e[n])return!1;return e.length>=2&&("number"==typeof e[0]||t.isListTarget(e[0])||"string"==typeof e[0])}},{key:"isListTarget",value:function(t){return"object"===f(t)&&null!==t&&Array.isArray(t.list)}},{key:"isObjectTarget",value:function(t,e){return"style"!==t&&"object"===f(e)&&null!==e&&!Array.isArray(e)&&Object.getPrototypeOf(e)===Object.prototype}},{key:"isChildrenTarget",value:function(t,e){return"children"===t&&"object"===f(e)}},{key:"getValueStepsCycles",value:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.getTargetCycle(r),a=n&&n.valueOnly,o=e.val(r),l=null,u=0,c=0,h=0;return function d(v){return Array.isArray(v)?a||!t.isValueStepsCycleArray(v)?[v,u,c,h]:Array.isArray(n)?n:(l=v[0],u=v.length>=2?v[1]:u,c=v.length>=3?v[2]:c,h=v.length>=4?v[3]:h,[l,u,c,h]):"object"===f(v)&&null!==v&&Object.getPrototypeOf(v)===Object.prototype?(l="function"==typeof v.value?v.value.call(e,i,o):s.isDefined(v.value)?v.value:v,u="function"==typeof v.steps?v.steps.call(e,i):s.isDefined(v.steps)?v.steps:0,c="function"==typeof v.interval?v.interval.call(e,i):s.isDefined(v.interval)?v.interval:0,h="function"==typeof v.cycles?v.cycles.call(e,i,e.getTargetCycles(r)):s.isDefined(v.cycles)?v.cycles:0,Array.isArray(l)?d(l):[l,u,c,h]):"function"==typeof v?d(v.call(e,i,o)):[v,u,c,h]}(n)}},{key:"getIntervalValue",value:function(t,e,n){var r="function"==typeof n?n.call(t,e):n;return s.isNumber(r)?r:0}},{key:"scheduleExecution",value:function(t,e){var n=t.getTargetInterval(e);if(n<=0)return 0;var r=s.now(),i=t.getScheduleTimeStamp(e);if(s.isDefined(i)){var a=r-i;return Math.max(n-a,0)}return t.setScheduleTimeStamp(e,r),n}},{key:"getTargetSchedulePeriod",value:function(t,e,n){var r,i=s.now(),a=0;return n>0?s.isDefined(t.getTargetTimeStamp(e))?a=(r=i-t.getTargetTimeStamp(e))<n?n-r:0:(t.setTargetTimeStamp(e,i),a=n):s.isDefined(t.getTargetTimeStamp(e))&&(a=(r=i-t.getTargetTimeStamp(e))<0?-r:0),a}},{key:"handleValueChange",value:function(t,e,n,r,i,a){"object"===f(t.targets[e])&&"function"==typeof t.targets[e].onValueChange&&!s.areEqual(n,r,t.targets[e].deepEquality)&&(t.targets[e].onValueChange.call(t,n,r,a),t.setTargetMethodName(e,"onValueChange"))}}],null&&v(e.prototype,null),n&&v(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,E(r.key),r)}}function k(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function S(t,e,n){return(e=E(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t){var e=function(t){if("object"!=T(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==T(e)?e:e+""}var M=k((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}));function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L(r.key),r)}}function L(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}g=M,S(M,"defaultTargetStyles",{position:"absolute",left:0,top:0,zIndex:1}),S(M,"transformMap",{x:!0,y:!0,z:!0,translateX:!0,translateY:!0,translateZ:!0,perspective:!0,rotate:!0,rotateX:!0,rotateY:!0,rotateZ:!0,rotate3DX:!0,rotate3DY:!0,rotate3DZ:!0,rotate3DAngle:!0,scale:!0,scaleX:!0,scaleY:!0,scaleZ:!0,scale3DX:!0,scale3DY:!0,scale3DZ:!0,skew:!0,skewX:!0,skewY:!0}),S(M,"dimMap",{width:!0,height:!0}),S(M,"styleWithUnitMap",{fontSize:!0,lineHeight:!0,borderRadius:!0,padding:!0,left:!0,top:!0,letterSpacing:!0}),S(M,"colorMap",{color:!0,background:!0,backgroundColor:!0}),S(M,"styleTargetMap",b(b(b(b(b({},g.transformMap),g.dimMap),g.styleWithUnitMap),g.colorMap),{},{opacity:!0,zIndex:!0,border:!0,borderTop:!0,borderLeft:!0,borderRight:!0,borderBottom:!0})),S(M,"asyncStyleTargetMap",{position:!0,css:!0,style:!0,textAlign:!0,boxSizing:!0,transformStyle:!0,transformOrigin:!0,attributes:!0,justifyContent:!0,alignItems:!0,display:!0,cursor:!0,fontFamily:!0,overflow:!0,overflowX:!0,overflowY:!0,textDecoration:!0,boxShadow:!0,fontWeight:!0,willChange:!0}),S(M,"scaleMap",{scale:!0,scaleX:!0,scaleY:!0,scaleZ:!0,scale3DX:!0,scale3DY:!0,scale3DZ:!0}),S(M,"rotate3D",{rotate3DX:!0,rotate3DY:!0,rotate3DZ:!0}),S(M,"attributeTargetMap",{lang:!0,autofocus:!0,placeholder:!0,autocomplete:!0,name:!0,type:!0,src:!0,href:!0,method:!0,size:!0,value:!0,maxlength:!0,minlength:!0,max:!0,min:!0,readonly:!0,required:!0,alt:!0,disabled:!0,action:!0,accept:!0,selected:!0,rows:!0,cols:!0,tabindex:!0}),S(M,"mustExecuteTargets",{width:!0,height:!0,heightFromDom:!0,widthFromDom:!0}),S(M,"coreTargetMap",{x:!0,y:!0}),S(M,"ignoreTargetMethodNameMap",b(b({},g.coreTargetMap),{},{isVisible:!0})),S(M,"cssFunctionMap",{skew:{x:0,y:0},translate3d:{x:0,y:0,z:0},rotate3d:{x:0,y:0,z:0,a:0},scale3d:{x:0,y:0,z:0}}),S(M,"bypassInitialProcessingTargetMap",{onChildrenChange:!0,onVisibleChildrenChange:!0,onPageClose:!0}),S(M,"controlTargetMap",{defaultStyling:!0,styling:!0,reuseDomDefinition:!0,useWindowFrame:!0,canDeleteDom:!0,domHolder:!0,interval:!0,onDomEvent:!0,canHaveDom:!0}),S(M,"events",{mouseStart:{pointerdown:{eventName:"mousedown",inputType:"pointer",eventType:"start",order:2,windowEvent:!1,queue:!0,rateLimit:0},mousedown:{eventName:"mousedown",inputType:"mouse",eventType:"start",order:3,windowEvent:!1,queue:!0,rateLimit:0}},mouseEnd:{pointerup:{eventName:"mouseup",inputType:"pointer",eventType:"end",order:2,windowEvent:!1,queue:!0,rateLimit:0},mouseup:{eventName:"mouseup",inputType:"mouse",eventType:"end",order:3,windowEvent:!1,queue:!0,rateLimit:0}},clickEvents:{click:{eventName:"click",inputType:"mouse",eventType:"click",order:1,windowEvent:!1,queue:!1,rateLimit:0}},touchStart:{touchstart:{eventName:"touchstart",inputType:"touch",eventType:"start",order:1,windowEvent:!1,queue:!0,rateLimit:0}},touchEnd:{touchend:{eventName:"touchend",inputType:"touch",eventType:"end",order:1,windowEvent:!1,queue:!0,rateLimit:0}},cancelEvents:{touchcancel:{eventName:"touchend",inputType:"touch",eventType:"cancel",order:1,windowEvent:!1,queue:!0,rateLimit:0},pointercancel:{eventName:"mousecancel",inputType:"pointer",eventType:"cancel",order:2,windowEvent:!1,queue:!0,rateLimit:0},mousecancel:{eventName:"mouseup",inputType:"mouse",eventType:"cancel",order:3,windowEvent:!1,queue:!0,rateLimit:0}},windowEvents:{keyup:{eventName:"key",inputType:"",eventType:"key",order:1,windowEvent:!0,queue:!0,rateLimit:50},keydown:{eventName:"key",inputType:"",eventType:"key",order:1,windowEvent:!0,queue:!0,rateLimit:50},blur:{eventName:"blur",inputType:"mouse",eventType:"cancel",order:2,windowEvent:!0,queue:!0,rateLimit:0},resize:{eventName:"resize",inputType:"",eventType:"resize",order:1,windowEvent:!0,queue:!0,rateLimit:50},orientationchange:{eventName:"resize",inputType:"",eventType:"resize",order:1,windowEvent:!0,queue:!0,rateLimit:50}},windowScroll:{scroll:{eventName:"scroll",inputType:"",eventType:"windowScroll",order:1,windowEvent:!0,queue:!0,rateLimit:50}},leaveEvents:{pointerleave:{eventName:"mouseleave",inputType:"pointer",eventType:"leave",order:2,windowEvent:!1,queue:!0,rateLimit:0},mouseleave:{eventName:"mouseleave",inputType:"mouse",eventType:"leave",order:3,windowEvent:!1,queue:!0,rateLimit:0}},enterEvents:{pointerenter:{eventName:"mouseenter",inputType:"pointer",eventType:"enter",order:2,windowEvent:!1,queue:!0,rateLimit:0},mouseenter:{eventName:"mouseenter",inputType:"mouse",eventType:"enter",order:3,windowEvent:!1,queue:!0,rateLimit:0}},moveEvents:{touchmove:{eventName:"touchmove",inputType:"touch",eventType:"move",order:1,windowEvent:!1,queue:!0,rateLimit:50},pointermove:{eventName:"mousemove",inputType:"pointer",eventType:"move",order:2,windowEvent:!1,queue:!0,rateLimit:50},mousemove:{eventName:"mousemove",inputType:"mouse",eventType:"move",order:3,windowEvent:!1,queue:!0,rateLimit:50}},documentEvents:{touchmove:{eventName:"touchmove",inputType:"touch",eventType:"move",order:1,windowEvent:!1,queue:!0,rateLimit:50},pointermove:{eventName:"mousemove",inputType:"pointer",eventType:"move",order:2,windowEvent:!1,queue:!0,rateLimit:50},mousemove:{eventName:"mousemove",inputType:"mouse",eventType:"move",order:3,windowEvent:!1,queue:!0,rateLimit:50},mouseleave:{eventName:"mouseleave",inputType:"mouse",eventType:"leave",order:3,windowEvent:!1,queue:!0,rateLimit:50},pointerup:{eventName:"mouseup",inputType:"pointer",eventType:"end",order:2,windowEvent:!1,queue:!0,rateLimit:0},mouseup:{eventName:"mouseup",inputType:"mouse",eventType:"end",order:3,windowEvent:!1,queue:!0,rateLimit:0},touchend:{eventName:"touchend",inputType:"touch",eventType:"end",order:1,windowEvent:!1,queue:!0,rateLimit:0}},wheelEvents:{wheel:{eventName:"wheel",inputType:"",eventType:"wheel",order:1,windowEvent:!1,queue:!0,rateLimit:50},mousewheel:{eventName:"wheel",inputType:"",eventType:"wheel",order:1,windowEvent:!1,queue:!0,rateLimit:50}}}),S(M,"targetToEventsMapping",{onStart:["touchStart","mouseStart"],onEnd:[],onKey:[],onClick:["clickEvents","touchStart","mouseStart"],onAnyClick:["clickEvents","touchStart","mouseStart"],onHover:["moveEvents"],onSwipe:["touchStart","mouseStart"],onAnySwipe:["touchStart","mouseStart"],onPinch:["touchStart"],onEnter:["enterEvents"],onLeave:["leaveEvents"],onScroll:["touchStart","mouseStart","wheelEvents"],onScrollLeft:["touchStart","mouseStart","wheelEvents"],onScrollTop:["touchStart","mouseStart","wheelEvents"],onWindowScroll:["windowScroll"]}),S(M,"touchEventMap",{onStart:function(t){return qe().isStartEvent()&&qe().isStartHandler(t)},onEnd:function(t){return qe().isEndEvent()&&qe().isEndHandler(t)},onAnySwipe:function(){return qe().isSwipeEvent()},onHover:function(t){return qe().isMoveEvent()&&qe().isHoverHandler(t)},onClick:function(t){return qe().isClickEvent()&&qe().isClickHandler(t)},onAnyClick:function(){return qe().isClickEvent()},onEnter:function(t){return qe().isEnterHandler(t)},onLeave:function(t){return qe().isLeaveHandler(t)},onSwipe:function(t){return qe().isSwipeHandler(t)&&qe().isSwipeEvent()}}),S(M,"internalEventMap",{onDomEvent:function(t){return t.hasDomNow},onVisible:function(t){return t.isNowVisible},onResize:function(t){var e=t.getDimLastUpdate(),n=t.getParent(),r=n?Math.max(n.getDimLastUpdate(),on()):on();return e>0&&r>e}}),S(M,"allEventMap",b(b({},g.touchEventMap),{},{onFocus:function(t){return qe().onFocus(t)},onBlur:function(t){return qe().onBlur(t)},onPinch:function(t){return qe().isPinchHandler(t)},onKey:function(){return"key"===qe().getEventType()&&qe().currentKey},onScroll:function(t){return qe().isScrollLeftHandler(t)&&qe().deltaX()||qe().isScrollTopHandler(t)&&qe().deltaY()},onScrollTop:function(t){return"horizontal"!==qe().getOrientation()&&qe().isScrollTopHandler(t)&&qe().deltaY()},onScrollLeft:function(t){return"vertical"!==qe().getOrientation()&&qe().isScrollLeftHandler(t)&&qe().deltaX()},onWindowScroll:function(){return"windowScroll"===qe().getEventType()}}));var D=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"linear",value:function(t){return t}},{key:"inQuad",value:function(t){return t*t}},{key:"outQuad",value:function(t){return t*(2-t)}},{key:"outExpo",value:function(t){return 1-(1-t)*(1-t)}},{key:"circular",value:function(t){return Math.sqrt(1- --t*t)}},{key:"inOutQuad",value:function(t){return t<.5?2*t*t:(4-2*t)*t-1}},{key:"inOut",value:function(t){return t<.5?2*t*t:(4-2*t)*t-1}},{key:"outElastic",value:function(t){var e=2*Math.PI/3;return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin((10*t-.75)*e)+1}}],null&&x(t.prototype,null),e&&x(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){A(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function A(t,e,n){return(e=I(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I(r.key),r)}}function I(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}var H=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e=t,n=[{key:"executeDeclarativeTarget",value:function(e,n,r){t.resolveTargetValue(e,n,r),t.updateTarget(e,e.targetValues[n],n),p.shouldActivateNextTarget(e,n)}},{key:"executeImperativeTarget",value:function(e,n,r,i,a,o,l,u){e.targetValues[n]=e.targetValues[n]||p.emptyValue();var c=e.targetValues[n];if(c.isImperative=!0,c.originalTargetName=l,c.originalTModel=u,p.isListTarget(r))t.assignListTarget(c,r.list,r.list[0],i,a,o);else if(p.isObjectTarget(n,r)){var h=M.cssFunctionMap[n]?j(j({},M.cssFunctionMap[n]),r):r;Object.keys(h).forEach((function(r){var c=h[r];if("object"===P(c)&&!p.isListTarget(c)){var d=p.getValueStepsCycles(e,h[r],n);c=d[0],i=s.isDefined(d[1])?d[1]:i,a=s.isDefined(d[2])?d[2]:a}t.executeImperativeTarget(e,r,c,i,a,o,l,u)}))}else if("object"!==P(r)||p.isListTarget(r))t.assignSingleTarget(c,r,void 0,i,0,a,o),c.step=0;else{var d=p.getValueStepsCycles(e,r,n);r!==d[0]?(r=d[0],i=s.isDefined(d[1])?d[1]:i,a=s.isDefined(d[2])?d[2]:a,t.executeImperativeTarget(e,n,r,i,a,o,l,u)):(t.assignSingleTarget(c,r,void 0,i,0,a,o),c.step=0)}t.updateTarget(e,c,n)}},{key:"updateTarget",value:function(e,n,r){n.executionCount++,n.executionFlag=!0,e.setActualValueLastUpdate(r),0===e.getTargetSteps(r)&&t.snapActualToTarget(e,r),e.addToStyleTargetList(r),e.setTargetMethodName(r,"value"),e.updateTargetStatus(r)}},{key:"assignListTarget",value:function(t,e,n,r,i,a){t.valueList=e,t.stepList=Array.isArray(r)?r:s.isDefined(r)?[r]:[1],t.intervalList=Array.isArray(i)?i:s.isDefined(i)?[i]:[0],t.easingList=Array.isArray(a)?a:s.isDefined(a)?[a]:[D.linear],t.cycle=1,t.value=e[1],t.initialValue=n,t.steps=t.stepList[0],t.interval=t.intervalList[0],t.easing=t.easingList[0],t.step=0,t.cycles=0}},{key:"executeEventHandlerTarget",value:function(t){"string"==typeof t?qe().attachGroupEvent(t):Array.isArray(t)&&t.forEach((function(t){return qe().attachGroupEvent(t)}))}},{key:"assignSingleTarget",value:function(t,e,n,r,i,a,o){delete t.valueList,delete t.stepList,delete t.intervalList,delete t.easingList,t.initialValue=n,t.value=e,t.steps=r||0,t.cycles=i||0,t.interval=a||0,t.easing=o}},{key:"snapActualToTarget",value:function(t,e){var n=t.val(e),r=t.targetValues[e].value;t.val(e,"function"==typeof r?r.call(t):r),p.handleValueChange(t,e,t.val(e),n,0,0)}},{key:"resolveTargetValue",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getTargetCycle(n),i=!e.targetValues[n]&&s.isDefined(e.targets[n].initialValue)?e.targets[n].initialValue:void 0,a=p.getValueStepsCycles(e,e.targets[n],n,r),o=a[0],l=a[1]||0,u=a[2]||0,c=a[3]||0,h=e.targetValues[n]||p.emptyValue();e.targetValues[n]=h;var d=s.isDefined(e.targets[n].easing)?e.targets[n].easing:void 0;if(p.isChildrenTarget(n,o)){var f=(Array.isArray(o)?o:[o]).map((function(t){return e.addChild(t),e.addedChildren.at(-1).child}));t.assignSingleTarget(h,Array.isArray(o)?f:f[0],void 0,0,c,u)}else if(p.isListTarget(o))t.assignListTarget(h,o.list,o.list[0],l,u,d);else{var v,y;l>0&&!s.areEqual(e.val(n),o,null!==(v=null===(y=e.targets[n])||void 0===y?void 0:y.deepEquality)&&void 0!==v&&v)&&e.resetTargetStep(n),t.assignSingleTarget(h,o,i,l,c,u,d)}}}],null&&V(e.prototype,null),n&&V(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function R(t){var e=function(t){if("object"!=N(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==N(e)?e:e+""}var U,Y,B,X=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e=t,n=[{key:"color2Integers",value:function(e){if(e=e?String(e):"",e=t.colors[e.toLowerCase()]||e){if(e.startsWith("#")){e=3===(e=e.slice(1)).length?e.split("").map((function(t){return t+t})).join(""):e;var n=parseInt(e,16);return[n>>16&255,n>>8&255,255&n]}var r=e.match(/\d+/g);return r&&3===r.length?r.map(Number):void 0}}}],null&&F(e.prototype,null),n&&F(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}();function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_(r.key),r)}}function _(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}U=X,B={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},(Y=R(Y="colors"))in U?Object.defineProperty(U,Y,{value:B,enumerable:!0,configurable:!0,writable:!0}):U[Y]=B;var q=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){return n&&W(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,0,[{key:"defaultActualValues",value:function(){return{x:0,y:0,width:0,height:0,leftMargin:0,rightMargin:0,topMargin:0,bottomMargin:0,opacity:1,scale:1,scrollLeft:0,scrollTop:0,textOnly:!0,borderRadius:0,children:[],isInFlow:!0,baseElement:"div",canHaveDom:!0,widthFromDom:!1,heightFromDom:!1,isIncluded:!0,bracketThreshold:10,bracketSize:5,preventDefault:void 0,canDeleteDom:void 0}}},{key:"shouldMeasureHeightFromDom",value:function(t){return!t.excludeDefaultStyling()&&!s.isDefined(t.targetValues.height)&&!s.isDefined(t.targets.height)&&!t.hasChildren()||!!t.getTargetValue("heightFromDom")}},{key:"shouldMeasureWidthFromDom",value:function(t){return!((t.excludeDefaultStyling()||t.reuseDomDefinition()||s.isDefined(t.targetValues.width)||s.isDefined(t.targets.width)||t.hasChildren())&&!t.getTargetValue("widthFromDom"))}},{key:"createDom",value:function(e){e.$dom=new d,e.$dom.create(e.getBaseElement()),e.$dom.setSelector("#".concat(e.oid)),e.$dom.setId(e.oid),e.$dom.stamp(),e.isTextOnly()?e.$dom.text(e.getHtml()):e.$dom.html(e.getHtml()),e.setActualValueLastUpdate("html"),e.domHeightTimestamp=0,e.domWidthTimestamp=0,e.transformMap={},e.styleMap={},e.allStyleTargetList.forEach((function(t){s.isDefined(e.val(t))&&e.addToStyleTargetList(t)})),t.fixStyle(e),t.fixAsyncStyle(e)}},{key:"getTransformValue",value:function(t,e){var n;return"x"===e?n=t.getTransformX():"y"===e?n=t.getTransformY():M.transformMap[e]&&(n=M.rotate3D[e]?t.val(e):M.scaleMap[e]?s.formatNum(t.val(e),2):t.floorVal(e)),n}},{key:"fixStyle",value:function(e){var n=!1;e.styleTargetList.forEach((function(r){if(M.transformMap[r]){var i=t.getTransformValue(e,r);e.transformMap[r]!==i&&(e.transformMap[r]=i,n=!0)}else if("width"===r){var a=Math.floor(e.getWidth());e.$dom.getStyleValue("width")!==a&&(e.styleMap.width=a,e.$dom.width(a))}else if("height"===r){var o=Math.floor(e.getHeight());e.$dom.getStyleValue("height")!==o&&(e.styleMap.height=o,e.$dom.height(o))}else M.styleWithUnitMap[r]?s.isDefined(e.val(r))&&e.styleMap[r]!==e.val(r)&&(e.$dom.style(r,s.isNumber(e.val(r))?"".concat(e.val(r),"px"):e.val(r)),e.styleMap[r]=e.val(r)):s.isDefined(e.val(r))&&e.styleMap[r]!==e.val(r)&&(e.$dom.style(r,"".concat(e.val(r))),e.styleMap[r]=e.val(r))})),n&&e.$dom.transform(t.getTransformString(e)),e.state().styleTargetMap={},e.state().styleTargetList=[]}},{key:"setWidthFromDom",value:function(t){var e=t.domWidthTimestamp,n=t.getParent(),r=t.getDomParent(),i=!1;if(Qe().needsRerender(t)&&(t.isTextOnly()?t.$dom.text(t.getHtml()):t.$dom.html(t.getHtml()),i=!0),i||n&&e<=n.getDimLastUpdate()||r&&e<=r.getDimLastUpdate()){t.$dom.width("auto");var a=t.$dom.width();t.domWidthTimestamp=s.now(),t.val("width",a),(a>0||0===a&&t.lastVal("width")>0)&&t.addToStyleTargetList("width"),Je().schedule(15,"resize")}}},{key:"setHeightFromDom",value:function(t){var e=t.domHeightTimestamp,n=t.getParent(),r=t.getDomParent(),i=!1;if(Qe().needsRerender(t)&&(t.isTextOnly()?t.$dom.text(t.getHtml()):t.$dom.html(t.getHtml()),i=!0),i||n&&e<=n.getDimLastUpdate()||r&&e<=r.getDimLastUpdate()){t.$dom.height("auto");var a=t.$dom.height();t.domHeightTimestamp=s.now(),t.val("height",a),(a>0||0===a&&t.lastVal("height")>0)&&t.addToStyleTargetList("height"),Je().schedule(15,"resize")}}},{key:"morph",value:function(t,e,n,r,i){var a=t.getTargetEasing(e),o=a?a(t.getTargetStepPercent(e,i)):t.getTargetStepPercent(e,i);if(M.colorMap[e]){var l=X.color2Integers(r),s=n?X.color2Integers(n):X.color2Integers("#fff");if(l&&s){var u=Math.floor(l[0]*o+s[0]*(1-o)),c=Math.floor(l[1]*o+s[1]*(1-o)),h=Math.floor(l[2]*o+s[2]*(1-o));return"rgb(".concat(u,",").concat(c,",").concat(h,")")}return r}return"number"==typeof r?r*o+n*(1-o):r}},{key:"fixAsyncStyle",value:function(t){t.asyncStyleTargetList.forEach((function(e){if("style"===e){var n=t.getStyle();s.isDefined(n)&&t.styleMap.style!==n&&(t.$dom.setStyleByMap(t.getStyle()),t.styleMap.style=n)}else if("attributes"===e){var r=t.getAttributes();s.isDefined(r)&&t.styleMap.attributes!==r&&(Object.keys(r).forEach((function(e){t.$dom.attr(e,r[e])})),t.styleMap.attributes=r)}else if("css"===e){var i=t.getCss();t.$dom.css()!==i&&t.$dom.css(i)}else M.attributeTargetMap[e]?t.$dom.attr(e,t.val(e)):s.isDefined(t.val(e))&&t.styleMap[e]!==t.val(e)&&(t.$dom.style(e,"".concat(t.val(e))),t.styleMap[e]=t.val(e))})),t.state().asyncStyleTargetMap={},t.state().asyncStyleTargetList=[]}},{key:"getTransformString",value:function(e){var n={},r={};(e.transformMap.translateX||e.transformMap.translateY||e.transformMap.translateZ)&&(delete e.transformMap.x,delete e.transformMap.y);for(var i=0,a=Object.keys(e.transformMap);i<a.length;i++){var o=a[i];if(!n[o])switch(o){case"translateX":case"translateY":case"translateZ":r[o]="".concat(o,"(").concat(e.transformMap[o],"px)"),n[o]=!0;break;case"x":case"y":case"z":s.isDefined(e.getZ())?r.translate3d="translate3d(".concat(e.transformMap.x,"px, ").concat(e.transformMap.y,"px, ").concat(e.transformMap.z,"px)"):(s.isDefined(e.getX())||s.isDefined(e.getY()))&&(r.translate="translate(".concat(e.transformMap.x,"px, ").concat(e.transformMap.y,"px)")),n.x=!0,n.y=!0,n.z=!0;break;case"rotate":case"rotateX":case"rotateY":case"rotateZ":case"rotate3DX":case"rotate3DY":case"rotate3DZ":case"rotate3DAngle":s.isDefined(e.val("rotate3DX"))&&s.isDefined(e.val("rotate3DY"))&&s.isDefined(e.val("rotate3DZ"))&&s.isDefined(e.val("rotate3DAngle"))?(r.rotate3d="rotate3d(".concat(e.transformMap.rotate3DX,", ").concat(e.transformMap.rotate3DY,", ").concat(e.transformMap.rotate3DZ,", ").concat(e.transformMap.rotate3DAngle,"deg)"),n.rotate3DX=!0,n.rotate3DY=!0,n.rotate3DZ=!0,n.rotate3DAngle=!0):s.isDefined(e.val(o))&&(r[o]="".concat(o,"(").concat(e.transformMap[o],"deg)"),n[o]=!0);break;case"scale":case"scaleX":case"scaleY":case"scaleZ":case"scale3DX":case"scale3DY":case"scale3DZ":s.isDefined(e.val("scale3DX"))&&s.isDefined(e.val("scale3DY"))&&s.isDefined(e.val("scale3DZ"))?(r.scale3d="scale3d(".concat(e.transformMap.scale3DX,", ").concat(e.transformMap.scale3DY,", ").concat(e.transformMap.scale3DZ,")"),n.scale3DX=!0,n.scale3DY=!0,n.scale3DZ=!0):s.isDefined(e.val(o))&&(r[o]="".concat(o,"(").concat(e.transformMap[o],")"),n[o]=!0);break;case"skewX":case"skewY":s.isDefined(e.val("skewX"))&&s.isDefined(e.val("skewY"))?(r[o]="skew(".concat(e.transformMap.skewX,"deg, ").concat(e.transformMap.skewY,"deg)"),n.skewX=!0,n.skewY=!0):s.isDefined(e.val(o))&&(r[o]="".concat(o,"(").concat(e.transformMap[o],"deg)"),n[o]=!0);break;case"perspective":s.isDefined(e.val("perspective"))&&(r[o]="perspective(".concat(e.transformMap.perspective,"px)"),n.perspective=!0)}}var l={};e.val("transformOrder")?e.val("transformOrder").forEach((function(t,e){l[t]=e})):l=t.transformOrder;var u=Object.keys(r).sort((function(t,e){return l[t]-l[e]})).map((function(t){return r[t]}));return u.join(" ")}}])}();function z(t,e){if(t){if("string"==typeof t)return K(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(t,e):void 0}}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Q(r.key),r)}}function Q(t){var e=function(t){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(e)?e:e+""}!function(t,e,n){(e=_(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(q,"transformOrder",{perspective:0,translateX:1,translateY:1,translateZ:1,translate:1,translate3d:1,rotate:2,rotateX:2,rotateY:2,rotateZ:2,rotate3d:2,skew:3,skewX:3,skewY:3,scale:4,scaleX:4,scaleY:4,scaleZ:4,scale3DX:4,scale3DY:4,scale3DZ:4});var J=function(){return function(t,e){return e&&G(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"object"===Z(e)&&void 0===n&&(n=e,e=""),this.type=e||"blank",this.targets=Object.assign({},n);var r=$e.getOid(this.type);this.oid=r.oid,this.oidNum=r.num,this._state={}}),[{key:"state",value:function(){return this._state}},{key:"targetValues",get:function(){var t,e;return null!==(e=(t=this.state()).targetValues)&&void 0!==e?e:t.targetValues={}},set:function(t){this.state().targetValues=t}},{key:"actualValues",get:function(){var t,e;return null!==(e=(t=this.state()).actualValues)&&void 0!==e?e:t.actualValues={}},set:function(t){this.state().actualValues=t}},{key:"lastActualValues",get:function(){var t,e;return null!==(e=(t=this.state()).lastActualValues)&&void 0!==e?e:t.lastActualValues={}}},{key:"activeTargetList",get:function(){var t,e;return null!==(e=(t=this.state()).activeTargetList)&&void 0!==e?e:t.activeTargetList=[]},set:function(t){this.state().activeTargetList=t}},{key:"activeTargetMap",get:function(){var t,e;return null!==(e=(t=this.state()).activeTargetMap)&&void 0!==e?e:t.activeTargetMap={}},set:function(t){this.state().activeTargetMap=t}},{key:"updatingTargetList",get:function(){var t,e;return null!==(e=(t=this.state()).updatingTargetList)&&void 0!==e?e:t.updatingTargetList=[]}},{key:"updatingTargetMap",get:function(){var t,e;return null!==(e=(t=this.state()).updatingTargetMap)&&void 0!==e?e:t.updatingTargetMap={}}},{key:"updatingChildrenList",get:function(){var t,e;return null!==(e=(t=this.state()).updatingChildrenList)&&void 0!==e?e:t.updatingChildrenList=[]}},{key:"updatingChildrenMap",get:function(){var t,e;return null!==(e=(t=this.state()).updatingChildrenMap)&&void 0!==e?e:t.updatingChildrenMap={}}},{key:"activeChildrenList",get:function(){var t,e;return null!==(e=(t=this.state()).activeChildrenList)&&void 0!==e?e:t.activeChildrenList=[]}},{key:"activeChildrenMap",get:function(){var t,e;return null!==(e=(t=this.state()).activeChildrenMap)&&void 0!==e?e:t.activeChildrenMap={}}},{key:"externalEventList",get:function(){var t,e;return null!==(e=(t=this.state()).externalEventList)&&void 0!==e?e:t.externalEventList=[]}},{key:"externalEventMap",get:function(){var t,e;return null!==(e=(t=this.state()).externalEventMap)&&void 0!==e?e:t.externalEventMap={}}},{key:"internalEventList",get:function(){var t,e;return null!==(e=(t=this.state()).internalEventList)&&void 0!==e?e:t.internalEventList=[]}},{key:"internalEventMap",get:function(){var t,e;return null!==(e=(t=this.state()).internalEventMap)&&void 0!==e?e:t.internalEventMap={}}},{key:"coreTargets",get:function(){var t,e;return null!==(e=(t=this.state()).coreTargets)&&void 0!==e?e:t.coreTargets=[]}},{key:"allStyleTargetList",get:function(){var t,e;return null!==(e=(t=this.state()).allStyleTargetList)&&void 0!==e?e:t.allStyleTargetList=[]}},{key:"allStyleTargetMap",get:function(){var t,e;return null!==(e=(t=this.state()).allStyleTargetMap)&&void 0!==e?e:t.allStyleTargetMap={}}},{key:"styleTargetList",get:function(){var t,e;return null!==(e=(t=this.state()).styleTargetList)&&void 0!==e?e:t.styleTargetList=[]}},{key:"styleTargetMap",get:function(){var t,e;return null!==(e=(t=this.state()).styleTargetMap)&&void 0!==e?e:t.styleTargetMap={}}},{key:"asyncStyleTargetList",get:function(){var t,e;return null!==(e=(t=this.state()).asyncStyleTargetList)&&void 0!==e?e:t.asyncStyleTargetList=[]}},{key:"asyncStyleTargetMap",get:function(){var t,e;return null!==(e=(t=this.state()).asyncStyleTargetMap)&&void 0!==e?e:t.asyncStyleTargetMap={}}},{key:"activatedTargets",get:function(){var t,e;return null!==(e=(t=this.state()).activatedTargets)&&void 0!==e?e:t.activatedTargets=[]}},{key:"targetMethodMap",get:function(){var t,e;return null!==(e=(t=this.state()).targetMethodMap)&&void 0!==e?e:t.targetMethodMap=[]}},{key:"targetExecutionCount",get:function(){var t,e;return null!==(e=(t=this.state()).targetExecutionCount)&&void 0!==e?e:t.targetExecutionCount=0},set:function(t){this.state().targetExecutionCount=t}},{key:"addedChildren",get:function(){var t,e;return null!==(e=(t=this.state()).addedChildren)&&void 0!==e?e:t.addedChildren=[]}},{key:"deletedChildren",get:function(){var t,e;return null!==(e=(t=this.state()).deletedChildren)&&void 0!==e?e:t.deletedChildren=[]}},{key:"movedChildren",get:function(){var t,e;return null!==(e=(t=this.state()).movedChildren)&&void 0!==e?e:t.movedChildren=[]}},{key:"lastChildrenUpdate",get:function(){var t,e;return null!==(e=(t=this.state()).lastChildrenUpdate)&&void 0!==e?e:t.lastChildrenUpdate={additions:[],deletions:[]}}},{key:"visibleChildren",get:function(){var t,e;return null!==(e=(t=this.state()).visibleChildren)&&void 0!==e?e:t.visibleChildren=[]}},{key:"getParent",value:function(){return this.parent}},{key:"initTargets",value:function(){var t=this;this.actualValues=q.defaultActualValues(),this.targetValues={},this.activeTargetMap={},this.activeTargetList=[],this.originalTargetNames=Object.keys(this.targets);var e=d.query("#".concat(this.oid));e||this.excludeDefaultStyling()?e&&!s.isDefined(this.targets.reuseDomDefinition)&&(this.targets.reuseDomDefinition=!0,this.targets.excludeX=!0,this.targets.excludeY=!0,this.targets.position="relative"):Object.entries(M.defaultTargetStyles).forEach((function(e){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a,o,l=[],s=!0,u=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(l.push(r.value),l.length!==e);s=!0);}catch(t){u=!0,i=t}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}(t,e)||z(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),r=n[0],i=n[1];r in t.targets||(t.targets[r]=i)})),Object.keys(this.targets).forEach((function(e){t.processNewTarget(e)}))}},{key:"processNewTarget",value:function(t){var e=this.targets[t],n=p.getTargetName(t);if(s.isDefined(e)){M.controlTargetMap[t]||(("object"!==Z(e)||Array.isArray(e))&&(this.targets[t]={value:e},e=this.targets[t]),p.bindTarget(this,t,this.originalTargetNames)),M.allEventMap[n]&&(this.externalEventMap[n]||(this.externalEventList.push(n),this.externalEventMap[n]=!0,e.active=!1)),M.internalEventMap[n]&&(this.internalEventMap[n]||(this.internalEventList.push(n),this.internalEventMap[n]=!0,e.active=!1));var r=t.startsWith("_");n!==t&&(this.targets[n]=this.targets[t],r&&(this.targets[n].active=!1),delete this.targets[t],t=n),M.bypassInitialProcessingTargetMap[t]||(s.isDefined(e.initialValue)&&this.val(t,e.initialValue),this.addToStyleTargetList(t),M.coreTargetMap[t]&&!this.coreTargets.includes(t)&&this.coreTargets.push(t),M.mustExecuteTargets[t]||!s.isStringBooleanOrNumber(e)?!1!==e.active&&this.canTargetBeActivated(t)&&this.addToActiveTargets(t):this.val(t,e))}else this.delVal("key")}},{key:"activate",value:function(t){tn().addToActivatedList(this),this.currentStatus="active",t&&this.isTargetEnabled(t)&&-1===this.activatedTargets.indexOf(t)&&this.activatedTargets.push(t)}},{key:"isActivated",value:function(){return"active"===this.currentStatus}},{key:"deactivate",value:function(){this.currentStatus=void 0}},{key:"shouldExecuteCyclesInParallel",value:function(t){var e;return!0===(null===(e=this.targets[t])||void 0===e?void 0:e.parallel)}},{key:"canTargetBeActivated",value:function(t){return!(Array.isArray(this.targets.onDomEvent)&&this.targets.onDomEvent.includes(t)&&!this.hasDom())}},{key:"addToStyleTargetList",value:function(t){if(!this.excludeStyling()&&!this.targets["exclude".concat(s.capitalizeFirstLetter(t))]){var e=M.asyncStyleTargetMap[t],n=M.attributeTargetMap[t];if(e||n)this.asyncStyleTargetMap[t]||(this.asyncStyleTargetList.push(t),this.asyncStyleTargetMap[t]=!0);else if(this.isStyleTarget(t)){var r=!0;if(M.transformMap[t])this.getParent()&&this.calcAbsolutePosition(this.getX(),this.getY()),q.getTransformValue(this,t)===this.transformMap[t]&&(r=!1);else if("width"===t||"height"===t){var i=Math.floor("width"===t?this.getWidth():this.getHeight());this.styleMap[t]===i&&(r=!1)}else s.isDefined(this.val(t))&&this.styleMap[t]===this.val(t)&&(r=!1);r&&!this.styleTargetMap[t]&&(this.styleTargetList.push(t),this.styleTargetMap[t]=!0)}else{if(!this.useWindowFrame(t)||this.styleTargetMap[t])return;this.styleTargetList.push(t),this.styleTargetMap[t]=!0}this.allStyleTargetMap[t]||(this.allStyleTargetList.push(t),this.allStyleTargetMap[t]=!0)}}},{key:"isStyleTarget",value:function(t){return M.styleTargetMap[t]}},{key:"useWindowFrame",value:function(t){return Array.isArray(this.targets.useWindowFrame)&&this.targets.useWindowFrame.includes(t)}},{key:"removeTarget",value:function(t){delete this.targets[t],this.removeFromActiveTargets(t),this.removeFromUpdatingTargets(t),delete this.targetValues[t]}},{key:"addTarget",value:function(t,e){this.addTargets(function(t,e,n){return(e=Q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t,e))}},{key:"addTargets",value:function(t){var e=this;Object.keys(t).forEach((function(n){e.targets[n]=t[n],e.removeFromUpdatingTargets(n),e.processNewTarget(n)})),Je().schedule(1,"addTargets-"+this.oid)}},{key:"getTargetStepPercent",value:function(t,e){var n=this.getTargetSteps(t);return e=s.isDefined(e)?e:this.getTargetStep(t),n?e/n:1}},{key:"resetTargetStep",value:function(t){return this.targetValues[t]&&(this.targetValues[t].step=0),this}},{key:"resetTargetExecutionFlag",value:function(t){return this.targetValues[t]&&(this.targetValues[t].executionFlag=!1),this}},{key:"resetTargetCycle",value:function(t){return this.targetValues[t]&&(this.targetValues[t].cycle=0),this}},{key:"resetScheduleTimeStamp",value:function(t){return this.targetValues[t]&&(this.targetValues[t].scheduleTimeStamp=void 0),this}},{key:"resetTargetInitialValue",value:function(t){return this.targetValues[t]&&(this.targetValues[t].initialValue=void 0),this}},{key:"updateTargetStatus",value:function(t){var e=this.targetValues[t];if(e){var n=this.getTargetCycle(t),r=this.getTargetCycles(t),i=this.getTargetStep(t),a=this.getTargetSteps(t);return this.isExecuted(t)&&i<a||Array.isArray(e.valueList)&&n<e.valueList.length-1?this.targetValues[t].status="updating":!this.isExecuted(t)||this.isTargetInLoop(t)||n<r?this.targetValues[t].status="active":this.targetValues[t].status="done",this.isTargetUpdating(t)?(this.addToUpdatingTargets(t),this.removeFromActiveTargets(t)):this.isTargetActive(t)?(this.addToActiveTargets(t),this.removeFromUpdatingTargets(t)):(this.removeFromActiveTargets(t),this.removeFromUpdatingTargets(t),Fe.manager.doneTargets.push({tmodel:this,key:t})),this.targetValues[t].status}}},{key:"getTargetStatus",value:function(t){return this.targetValues[t]?this.targetValues[t].status:""}},{key:"isTargetActive",value:function(t){return this.targetValues[t]&&"active"===this.targetValues[t].status}},{key:"isTargetUpdating",value:function(t){return this.targetValues[t]&&"updating"===this.targetValues[t].status}},{key:"isTargetDone",value:function(t){return this.targetValues[t]&&"done"===this.targetValues[t].status}},{key:"isTargetComplete",value:function(t){return this.targetValues[t]&&"complete"===this.targetValues[t].status}},{key:"isExecuted",value:function(t){return this.targetValues[t]&&this.targetValues[t].executionFlag}},{key:"neverExecuted",value:function(t){return!this.targetValues[t]}},{key:"isTargetImperative",value:function(t){return!!this.targetValues[t]&&this.targetValues[t].isImperative}},{key:"getTargetExecutionCount",value:function(t){return this.targetValues[t]?this.targetValues[t].executionCount:0}},{key:"setTargetComplete",value:function(t){this.targetValues[t]&&(this.targetValues[t].status="complete")}},{key:"isTargetEnabled",value:function(t){var e=this.targets[t];return!!s.isDefined(e)&&("function"!=typeof e.enabledOn||(this.setTargetMethodName(t,"enabledOn"),e.enabledOn.call(this)))}},{key:"isTargetInLoop",value:function(t){return!!this.targets[t]&&("function"==typeof this.targets[t].loop?this.targets[t].loop.call(this,t):this.targets[t].loop)}},{key:"doesTargetEqualActual",value:function(t){if(this.targetValues[t]){var e=!!this.targets[t]&&this.targets[t].deepEquality;return e?s.areEqual(this.getTargetValue(t),this.val(t),e):this.getTargetValue(t)===this.val(t)}return!1}},{key:"getTargetValue",value:function(t){return this.targetValues[t]?"function"==typeof this.targetValues[t].value?this.targetValues[t].value.call(this):this.targetValues[t].value:void 0}},{key:"getTargetSteps",value:function(t){return this.targetValues[t]&&this.targetValues[t].steps||0}},{key:"getTargetStep",value:function(t){return this.targetValues[t]?this.targetValues[t].step:0}},{key:"getScheduleTimeStamp",value:function(t){return this.targetValues[t]?this.targetValues[t].scheduleTimeStamp:void 0}},{key:"isScheduledPending",value:function(t){var e=this.getScheduleTimeStamp(t),n=this.getTargetInterval(t);return e&&e+n>s.now()}},{key:"shouldScheduleRun",value:function(t){var e,n;return null===(e=null===(n=this.targets[t])||void 0===n?void 0:n.triggerRerun)||void 0===e||e}},{key:"getTargetInitialValue",value:function(t){var e;return null===(e=this.targetValues[t])||void 0===e?void 0:e.initialValue}},{key:"getActualValueLastUpdate",value:function(t){var e;return null===(e=this.targetValues[t])||void 0===e?void 0:e.actualValueLastUpdate}},{key:"getDimLastUpdate",value:function(){return Math.max(this.getActualValueLastUpdate("width")||0,this.getActualValueLastUpdate("height")||0,this.domHeightTimestamp,this.domWidthTimestamp)}},{key:"getTargetCreationTime",value:function(t){return this.targetValues[t]?this.targetValues[t].creationTime:void 0}},{key:"incrementTargetStep",value:function(t,e,n,r,i){var a=this.targetValues[t];if(a){var o=r||8,l=e-n,s=Math.max(1,Math.floor(l/o));return a.step=Math.min(i,a.step+s),a.step}}},{key:"getTargetCycles",value:function(t){return this.targetValues[t]&&this.targetValues[t].cycles||0}},{key:"getTargetCycle",value:function(t){return this.targetValues[t]?this.targetValues[t].cycle:0}},{key:"incrementTargetCycle",value:function(t){return this.targetValues[t]&&this.targetValues[t].cycle++,this.targetValues[t].cycle}},{key:"setTargetInterval",value:function(t,e){return this.targetValues[t]&&(this.targetValues[t].interval=e),this.targetValues[t].interval}},{key:"setScheduleTimeStamp",value:function(t,e){this.targetValues[t]&&(this.targetValues[t].scheduleTimeStamp=e)}},{key:"setTargetInitialValue",value:function(t,e){this.targetValues[t]&&(this.targetValues[t].initialValue=e)}},{key:"setActualValueLastUpdate",value:function(t){this.targetValues[t]&&(this.targetValues[t].actualValueLastUpdate=s.now())}},{key:"getTargetEasing",value:function(t){return"function"==typeof this.targetValues[t].easing?this.targetValues[t].easing:void 0}},{key:"getTargetInterval",value:function(t){var e=this.targetValues[t];return(null==e?void 0:e.interval)||0}},{key:"setTarget",value:function(t,e,n,r,i){if("object"===Z(t)&&null!==t){var a=[t,e,n,r,i];e=a[0],n=a[1],r=a[2],i=a[3],t=""}var o=p.currentTargetName,l=p.currentTModel;return this.getParent()===l&&p.markTargetAction(l,"childAction"),H.executeImperativeTarget(this,t,e,n,r,i,o,l),this}},{key:"hasTargetUpdates",value:function(t){return t?!0===this.updatingTargetMap[t]:this.updatingTargetList.length>0}},{key:"addToActiveTargets",value:function(t){var e=this;if(!this.activeTargetMap[t]&&this.canTargetBeActivated(t)){var n;this.activeTargetMap[t]=!0;var r=["y","x","height","width","start"];-1!==r.indexOf(t)?(this.activeTargetList=this.activeTargetList.filter((function(t){return!r.includes(t)})),r.forEach((function(t){e.activeTargetMap[t]&&e.activeTargetList.unshift(t)}))):this.activeTargetList.push(t),null===(n=this.getParent())||void 0===n||n.addToActiveChildren(this)}}},{key:"removeFromActiveTargets",value:function(t){if(this.activeTargetMap[t]){delete this.activeTargetMap[t];var e,n=this.activeTargetList.indexOf(t);n>=0&&this.activeTargetList.splice(n,1),0===this.activeTargetList.length&&(null===(e=this.getParent())||void 0===e||e.removeFromActiveChildren(this))}}},{key:"addToUpdatingTargets",value:function(t){var e;this.updatingTargetMap[t]||(this.updatingTargetMap[t]=!0,this.updatingTargetList.push(t),null===(e=this.getParent())||void 0===e||e.addToUpdatingChildren(this))}},{key:"removeFromUpdatingTargets",value:function(t){if(this.updatingTargetMap[t]){delete this.updatingTargetMap[t];var e,n=this.updatingTargetList.indexOf(t);n>=0&&this.updatingTargetList.splice(n,1),0===this.updatingTargetList.length&&(null===(e=this.getParent())||void 0===e||e.removeFromUpdatingChildren(this))}}},{key:"hasUpdatingTargets",value:function(t){var e,n=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=z(t))){e&&(t=e);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(o)throw i}}}}(this.updatingTargetList);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(this.isTargetImperative(r)&&this.targetValues[r].originalTargetName===t)return!0}}catch(t){n.e(t)}finally{n.f()}return!1}},{key:"addToUpdatingChildren",value:function(t){this.updatingChildrenMap[t.oid]||(this.updatingChildrenMap[t.oid]=!0,this.updatingChildrenList.push(t))}},{key:"removeFromUpdatingChildren",value:function(t){if(this.updatingChildrenMap[t.oid]){delete this.updatingChildrenMap[t.oid];var e=this.updatingChildrenList.indexOf(t);e>=0&&this.updatingChildrenList.splice(e,1)}}},{key:"hasUpdatingChildren",value:function(){return this.updatingChildrenList.length>0}},{key:"addToActiveChildren",value:function(t){this.activeChildrenMap[t.oid]||(this.activeChildrenMap[t.oid]=!0,this.activeChildrenList.push(t))}},{key:"removeFromActiveChildren",value:function(t){if(this.activeChildrenMap[t.oid]){delete this.activeChildrenMap[t.oid];var e=this.activeChildrenList.indexOf(t);e>=0&&this.activeChildrenList.splice(e,1)}}},{key:"hasActiveChildren",value:function(){return this.activeChildrenList.length>0}},{key:"deleteTargetValue",value:function(t){var e=this.targetValues[t];return delete this.targetValues[t],this.addToActiveTargets(t),this.removeFromUpdatingTargets(t),e&&Je().schedule(1,"deleteTargetValue-"+this.oid+"-"+t),this}},{key:"resetImperative",value:function(t){var e=this.targetValues[t],n=null==e?void 0:e.isImperative;return e&&(e.isImperative=!1,e.executionFlag=!1,e.scheduleTimeStamp=void 0,e.step=0,e.cycle=0,e.steps=0,e.cycles=0,e.interval=0),n&&Je().schedule(1,"resetImperative-"+this.oid+"-"+t),this}},{key:"activateTarget",value:function(t,e){if(this.canTargetBeActivated(t)){s.isDefined("value")&&this.val("__".concat(t),e);var n=this.targetValues[t];n?(n.isImperative=!1,n.executionFlag=!1,n.scheduleTimeStamp=void 0,n.step=0,n.cycle=Array.isArray(n.valueList)?1:0,this.updateTargetStatus(t)):this.addToActiveTargets(t),this.activate(t)}return this}},{key:"manageChildTargetExecution",value:function(t,e){return e||this.shouldCalculateChildTargets()||t.hasChildren()||t.addedChildren.length>0||0===t.targetExecutionCount}},{key:"shouldCalculateChildTargets",value:function(){return this.val("shouldCalculateChildTargets")}},{key:"getCoreTargets",value:function(){var t=this.val("coreTargets");return s.isDefined(t)?t:this.state().coreTargets}},{key:"setTargetMethodName",value:function(t,e){(!M.ignoreTargetMethodNameMap[t]||this.isTargetUpdating(t)||this.isTargetImperative(t))&&(this.targetMethodMap[t]||(this.targetMethodMap[t]=[]),this.targetMethodMap[t].includes(e)||this.targetMethodMap[t].push(e))}}])}();function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nt(r.key),r)}}function nt(t){var e=function(t){if("object"!=tt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==tt(e)?e:e+""}var rt=function(){return function(t,e){return e&&et(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.xNext=0,this.xNorth=0,this.xWest=0,this.xEast=0,this.xSouth=0,this.scrollLeft=0,this.scrollTop=0,this.absX=0,this.xOverflowReset=0,this.xOverflowLimit=0,this.yNext=0,this.yNorth=0,this.yWest=0,this.yEast=0,this.ySouth=0}),[{key:"setCurrentChild",value:function(t){this.currentChild=t}},{key:"setLocation",value:function(){this.currentChild.x=this.xNext+this.currentChild.getLeftMargin(),this.currentChild.y=this.yNext+this.currentChild.getTopMargin()}},{key:"isOverflow",value:function(){var t=this.currentChild.getMinWidth();return this.absX+this.currentChild.x+t+this.currentChild.getLeftMargin()>this.xOverflowLimit}},{key:"overflow",value:function(){this.xNext=this.scrollLeft-this.absX+this.xOverflowReset,this.yNext=this.ySouth}},{key:"appendNewLine",value:function(){var t=this.currentChild.getHeight()*this.currentChild.getMeasuringScale();this.xNext=this.scrollLeft-this.absX+this.xOverflowReset,this.yNext=this.ySouth>this.yNext?this.ySouth+this.currentChild.val("appendNewLine"):this.ySouth+t+this.currentChild.val("appendNewLine"),this.yEast=this.yNext,this.xSouth=this.xNext,this.ySouth=Math.max(this.yNext,this.ySouth),this.currentChild.getRealParent().viewport.xEast=Math.max(this.currentChild.getRealParent().viewport.xEast,this.xEast),this.currentChild.getRealParent().viewport.ySouth=Math.max(this.currentChild.getRealParent().viewport.ySouth,this.ySouth)}},{key:"nextLocation",value:function(){var t=this.currentChild.getHeight()*this.currentChild.getMeasuringScale(),e=this.currentChild.getBaseWidth()*this.currentChild.getMeasuringScale(),n=this.currentChild.getTopBaseHeight()*this.currentChild.getMeasuringScale(),r=this.yNext+t+this.currentChild.getTopMargin()+this.currentChild.getBottomMargin();this.xNext+=e+this.currentChild.getLeftMargin()+this.currentChild.getRightMargin(),this.yNext+=n,this.xSouth=this.xNext,this.yEast=this.yNext,this.xEast=Math.max(this.xNext,this.xEast),this.ySouth=Math.max(r,this.ySouth),this.currentChild.getRealParent().viewport.xEast=Math.max(this.currentChild.getRealParent().viewport.xEast,this.xEast),this.currentChild.getRealParent().viewport.ySouth=Math.max(this.currentChild.getRealParent().viewport.ySouth,this.ySouth)}}])}();function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function at(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ot(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ot(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ut(r.key),r)}}function st(t,e,n){return(e=ut(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ut(t){var e=function(t){if("object"!=it(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=it(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==it(e)?e:e+""}var ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){return n&&lt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,0,[{key:"clear",value:function(){t.foundParentWithType={},t.foundParentWithTarget={},t.foundTypeMap={},t.foundTargetMap={},t.foundOids={},t.foundHandler={}}},{key:"findFirstScrollHandler",value:function(e,n,r){if(e){var i="".concat(e.oid," ").concat(n," ").concat(r);if(t.foundHandler[i])return t.foundHandler[i];var a=this.findScrollHandler(e,r,n);return a&&(t.foundHandler[i]=a),a}}},{key:"findFirstHandler",value:function(e,n){if(e){var r="".concat(e.oid," ").concat(n);if(t.foundHandler[r])return t.foundHandler[r];var i=this.findEventHandler(e,n);return i&&(t.foundHandler[r]=i),i}}},{key:"findFirstScrollTopHandler",value:function(t,e){return this.findFirstScrollHandler(t,"onScrollTop",e)}},{key:"findFirstScrollLeftHandler",value:function(t,e){return this.findFirstScrollHandler(t,"onScrollLeft",e)}},{key:"findFirstPinchHandler",value:function(t){return this.findFirstHandler(t,"onPinch")}},{key:"findFirstSwipeHandler",value:function(t){return this.findFirstHandler(t,"onSwipe")}},{key:"findFirstEnterHandler",value:function(t){return this.findFirstHandler(t,"onEnter")}},{key:"findFirstLeaveHandler",value:function(t){return this.findFirstHandler(t,"onLeave")}},{key:"findFirstClickHandler",value:function(t){return this.findFirstHandler(t,"onClick")||this.findFirstHandler(t,"onAnyClick")}},{key:"findScrollHandler",value:function(t,e,n){for(;t&&(!t.canHandleEvent("onSwipe")||"wheel"===e);){if(t.canHandleEvent(n)||t.canHandleEvent("onScroll"))return t;t=t.getParent()}}},{key:"findEventHandler",value:function(t,e){for(;t;){if(t.canHandleEvent(e))return t;t=t.getParent()}}},{key:"findParentByType",value:function(e,n){var r="".concat(e.oid,"__").concat(n);if(!s.isDefined(t.foundParentWithType[r]))for(var i=e.getParent();i;){if(i.type===n){t.foundParentWithType[r]=i;break}i=i.getParent()}return t.foundParentWithType[r]}},{key:"findParentByTarget",value:function(e,n){var r="".concat(e.oid,"__").concat(n);if(!s.isDefined(t.foundParentWithTarget[r]))for(var i=e.getParent();i;){if(s.isDefined(i.targets[n])||s.isDefined(i.targetValues[n])){t.foundParentWithTarget[r]=i;break}i=i.getParent()}return t.foundParentWithTarget[r]}},{key:"findByType",value:function(e){if(!s.isDefined(t.foundTypeMap[e])){var n=function(t){if(t.type===e)return t;var r,i=at(t.getChildren());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a&&a.hasChildren()){var o=n(a);if(o)return o}else if(a&&a.type===e)return a}}catch(t){i.e(t)}finally{i.f()}},r=n(Fe.tRoot);r&&(t.foundTypeMap[e]=r)}return t.foundTypeMap[e]}},{key:"findByTarget",value:function(e){if(!s.isDefined(t.foundTargetMap[e])){var n=function(t){if(t.targets[e])return t;var r,i=at(t.getChildren());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a&&a.hasChildren()){var o=n(a);if(o)return o}else if(a&&a.targets[e])return a}}catch(t){i.e(t)}finally{i.f()}},r=n(Fe.tRoot);r&&(t.foundTargetMap[e]=r)}return t.foundTargetMap[e]}},{key:"find",value:function(e){if(!s.isDefined(t.foundOids[e])){var n=function(t){if(t.oid===e)return t;var r,i=at(t.getChildren());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a&&a.hasChildren()){var o=n(a);if(o)return o}else if(a&&a.oid===e)return a}}catch(t){i.e(t)}finally{i.f()}},r=n(Fe.tRoot);r&&(t.foundOids[e]=r)}return t.foundOids[e]}}])}();function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ft(r.key),r)}}function ft(t){var e=function(t){if("object"!=ht(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ht(e)?e:e+""}function vt(t,e,n){return e=gt(e),function(t,e){if(e&&("object"==ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yt()?Reflect.construct(e,n||[],gt(t).constructor):e.apply(t,n))}function yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(yt=function(){return!!t})()}function gt(t){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gt(t)}function pt(t,e){return pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pt(t,e)}st(ct,"foundParentWithType",{}),st(ct,"foundParentWithTarget",{}),st(ct,"foundTypeMap",{}),st(ct,"foundTargetMap",{}),st(ct,"foundOids",{}),st(ct,"foundHandler",{});var mt=function(t){function e(t,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=vt(this,e,[t,n])).allChildrenList=[],r.allChildrenMap={},r.childrenUpdateFlag=!1,r.$dom=null,r.x=0,r.y=0,r.absX=0,r.absY=0,r.domHeightTimestamp=0,r.domWidthTimestamp=0,r.contentWidth=0,r.contentHeight=0,r.bottomBaseWidth=0,r.topBaseHeight=0,r.styleMap={},r.transformMap={},r.visibilityStatus=void 0,r.isNowInvisible=!1,r.hasDomNow=!1,r.isNowVisible=!1,r.currentStatus="new",r.initTargets(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pt(t,e)}(e,t),function(t,e){return e&&dt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"createViewport",value:function(){this.viewport=this.viewport||new rt;var t=-this.getScrollLeft(),e=-this.getScrollTop(),n=t,r=e;for(var i in this.viewport.xNext=n,this.viewport.xNorth=n,this.viewport.xEast=n,this.viewport.xSouth=n,this.viewport.xWest=n,this.viewport.scrollLeft=t,this.viewport.scrollTop=e,this.viewport.absX=this.absX,this.viewport.absY=this.absY,this.viewport.xOverflowReset=this.absX,this.viewport.xOverflowLimit=this.absX+this.getWidth(),this.viewport.yNext=r,this.viewport.yNorth=r,this.viewport.yWest=r,this.viewport.yEast=r,this.viewport.ySouth=r,Object.assign(this.viewport,this.val("viewport")||{}),this.viewport){var a="viewport_".concat(i);s.isDefined(this.val(a))&&(this.viewport[i]=this.val(a))}return this.viewport}},{key:"calcAbsolutePosition",value:function(t,e){this.absX=s.isDefined(this.val("absX"))?this.val("absX"):this.getParent().absX+t,this.absY=s.isDefined(this.val("absY"))?this.val("absY"):this.getParent().absY+e}},{key:"addChild",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.addedChildren.length+this.allChildrenList.length;if(p.markTargetAction(this,"childAction"),"object"===ht(t)){if(this.childrenUpdateFlag=!0,!(t instanceof e)){var i=Object.keys(this.actualValues).find((function(e){return n.actualValues[e]===t}));i?(t=new e(t.id||i,t),this.actualValues[i]=t):t=t.id?new e(t.id,t):new e("".concat(this.oid,"_"),t)}this.addedChildren.push({index:r,child:t}),t.parent=this,t.updatingTargetList.length>0&&this.addToUpdatingChildren(t),t.activeTargetList.length>0&&this.addToActiveChildren(t),t.activate()}return this}},{key:"removeChild",value:function(t){return this.deletedChildren.push(t),this.removeFromUpdatingChildren(t),this.childrenUpdateFlag=!0,Je().schedule(1,"removeChild-"+this.oid+"-"+t.oid),this}},{key:"moveChild",value:function(t,e){return this.movedChildren.push({index:e,child:t}),t.hasDom()&&t.requiresDomRelocation()&&(t.domOrderIndex=e,t.activate()),this.childrenUpdateFlag=!0,Je().schedule(1,"moveChild-"+this.oid+"-"+t.oid),this}},{key:"getChildren",value:function(){var t,e,n,r=this,i=this.state();if((null===(t=i.deletedChildren)||void 0===t?void 0:t.length)>0&&(this.deletedChildren.forEach((function(t){if(r.allChildrenMap[t.oid]){var e=r.allChildrenList.indexOf(t);r.lastChildrenUpdate.deletions.push(t),r.allChildrenList.splice(e,1),delete r.allChildrenMap[t.oid]}})),this.deletedChildren.length=0),(null===(e=i.addedChildren)||void 0===e?void 0:e.length)>0&&(this.addedChildren.sort((function(t,e){return t.index-e.index})),this.addedChildren.forEach((function(t){var e=t.index,n=t.child;r.allChildrenMap[n.oid]||(s.isDefined(n.val("canDeleteDom"))||!1!==r.val("canDeleteDom")||n.val("canDeleteDom",!1),e>=r.allChildrenList.length?r.allChildrenList.push(n):r.allChildrenList.splice(e,0,n),r.allChildrenMap[n.oid]=n,r.lastChildrenUpdate.additions.push({index:e,child:n}))})),this.addedChildren.length=0),(null===(n=i.movedChildren)||void 0===n?void 0:n.length)>0){this.movedChildren.sort((function(t,e){return t.index-e.index}));var a={},o={};this.movedChildren.forEach((function(t){var e=t.index,n=t.child;r.lastChildrenUpdate.deletions.push(n),r.lastChildrenUpdate.additions.push({index:e,child:n});var i=r.allChildrenList.indexOf(n);if(e!==i){o[n.oid]&&delete o[n.oid];var l=r.allChildrenList.splice(e,1,n);!a[e]&&l.length>0&&(o[l[0].oid]={child:l[0],index:e+1}),i>=0&&(a[i]={fromIndex:i<e?i:e,child:n}),a[e]&&delete a[e]}})),Object.values(o).forEach((function(t){var e=t.index,n=t.child;r.allChildrenList.splice(e,0,n)})),Object.values(a).forEach((function(t){var e=t.fromIndex,n=t.child,i=r.allChildrenList.indexOf(n,e);r.allChildrenList.splice(i,1)})),this.movedChildren.length=0}return this.allChildrenList}},{key:"removeAll",value:function(){return this.allChildrenList=[],this.allChildrenMap={},this.state().updatingChildrenList=[],this.state().updatingChildrenMap={},this.hasDom()&&this.$dom.deleteAll(),this}},{key:"addToParentVisibleChildren",value:function(){this.isVisible()&&this.isInFlow()&&this.getParent()&&this.getParent().visibleChildren.push(this)}},{key:"shouldCalculateChildren",value:function(){if(s.isDefined(this.val("calculateChildren")))return this.val("calculateChildren");var t=this.isIncluded()&&(this.isVisible()||"new"===this.currentStatus)&&(this.hasChildren()||this.childrenUpdateFlag||this.getContentHeight()>0);return this.currentStatus=void 0,t}},{key:"getFirstChild",value:function(){return this.getChildren()[0]}},{key:"hasChildren",value:function(){return this.getChildren().length>0}},{key:"findChildren",value:function(t){return this.getChildren().filter((function(e){return e.type===t}))}},{key:"getLastChild",value:function(){return this.getChildren()[this.allChildrenList.length-1]}},{key:"getChild",value:function(t){return this.getChildren()[t]}},{key:"getChildIndex",value:function(t){return this.getChildren().indexOf(t)}},{key:"getChildrenOids",value:function(){return this.getChildren().map((function(t){return t.oid})).join(" ")}},{key:"findChild",value:function(t){return this.getChildren().find((function(e){return e.type===t}))}},{key:"findLastChild",value:function(t){return this.getChildren().findLast((function(e){return e.type===t}))}},{key:"getChildByOid",value:function(t){return this.allChildrenMap[t]}},{key:"getParentValue",value:function(t){var e=ct.findParentByTarget(this,t);return e?e.val(t):void 0}},{key:"delVal",value:function(t){t.startsWith("_")?delete this[t.slice(1)]:delete this.actualValues[t]}},{key:"val",value:function(t,e){var n=this.actualValues,r=this.lastActualValues;return t.startsWith("_")&&(n=this,t=t.slice(1)),void 0!==e?(r[t]=n[t],e!==n[t]&&(n[t]=e),this):n[t]}},{key:"lastVal",value:function(t){return this.lastActualValues[t]}},{key:"floorVal",value:function(t){return Math.floor(this.val(t))}},{key:"getDomParent",value:function(){return this.val("domParent")||ct.findParentByTarget(this,"domHolder")}},{key:"getDomHolder",value:function(t){var e=this.val("domHolder"),n=this.getDomParent();return!0===e&&t!==this?this.$dom:e&&!0!==e&&t.$dom!==e?e:n?n.$dom:null}},{key:"bug",value:function(){return[{visible:this.isVisible()},{visibilityStatus:this.visibilityStatus},{hasDom:this.hasDom()},{x:this.getX()},{y:this.getY()},{width:this.getWidth()},{height:this.getHeight()},{activeTargetList:this.activeTargetList},{updatingTargetList:this.updatingTargetList},{updatingChildrenList:this.updatingChildrenList},{activeChildrenList:this.activeChildrenList},{children:this.getChildren()},{targetValues:this.targetValues},{actualValues:this.actualValues}]}},{key:"logTree",value:function(){s.logTree(this)}},{key:"isVisible",value:function(){return this.val("isVisible")}},{key:"calcVisibility",value:function(){return s.calcVisibility(this)}},{key:"validateVisibilityInParent",value:function(){return!!s.isDefined(this.val("validateVisibilityInParent"))&&this.val("validateVisibilityInParent")}},{key:"hasDomHolderChanged",value:function(){return!this.reuseDomDefinition()&&this.getDomHolder(this)&&this.getDomHolder(this).exists()&&this.$dom.parent()!==this.getDomHolder(this).element}},{key:"hasBaseElementChanged",value:function(){return this.getBaseElement()!==this.$dom.getTagName()}},{key:"hasDom",value:function(){return!!this.$dom&&this.$dom.exists()}},{key:"getRealParent",value:function(){return this.parent}},{key:"getContentHeight",value:function(){return this.contentHeight}},{key:"getContentWidth",value:function(){return this.contentWidth}},{key:"calcContentWidthHeight",value:function(){this.contentHeight=this.viewport.ySouth-this.viewport.yNorth,this.topBaseHeight=this.viewport.yEast-this.viewport.yNorth,this.bottomBaseWidth=this.viewport.xSouth-this.viewport.xWest,this.contentWidth=this.viewport.xEast-this.viewport.xWest}},{key:"getBaseWidth",value:function(){var t;return null!==(t=this.val("baseWidth"))&&void 0!==t?t:this.getWidth()}},{key:"getMinWidth",value:function(){var t;return null!==(t=this.val("minWidth"))&&void 0!==t?t:this.getWidth()}},{key:"getTopBaseHeight",value:function(){var t;return null!==(t=this.val("topBaseHeight"))&&void 0!==t?t:0}},{key:"getContainerOverflowMode",value:function(){var t;return null!==(t=this.val("containerOverflowMode"))&&void 0!==t?t:"auto"}},{key:"getItemOverflowMode",value:function(){var t;return null!==(t=this.val("itemOverflowMode"))&&void 0!==t?t:"auto"}},{key:"getUIDepth",value:function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}},{key:"isTextOnly",value:function(){return this.val("textOnly")}},{key:"getHtml",value:function(){return this.val("html")}},{key:"isInFlow",value:function(){return!s.isDefined(this.val("isInFlow"))||this.val("isInFlow")}},{key:"canHandleEvent",value:function(t){var e,n;return null!==(e=null===(n=this.state().externalEventMap)||void 0===n?void 0:n[t])&&void 0!==e&&e}},{key:"preventDefault",value:function(){return s.isDefined(this.val("preventDefault"))?this.val("preventDefault"):this.getParentValue("preventDefault")||!1}},{key:"canDeleteDom",value:function(){return s.isDefined(this.val("canDeleteDom"))?this.val("canDeleteDom"):!this.reuseDomDefinition()}},{key:"excludeDefaultStyling",value:function(){return!1===this.targets.defaultStyling||this.excludeStyling()||this.reuseDomDefinition()&&0===this.allStyleTargetList.length}},{key:"excludeStyling",value:function(){return!1===this.targets.styling}},{key:"getBracketThreshold",value:function(){return this.val("bracketThreshold")}},{key:"getBracketSize",value:function(){return this.val("bracketSize")}},{key:"shouldBeBracketed",value:function(){return s.isDefined(this.val("shouldBeBracketed"))?this.val("shouldBeBracketed"):this.getChildren().length>this.getBracketThreshold()}},{key:"isIncluded",value:function(){return this.val("isIncluded")}},{key:"canHaveDom",value:function(){return!(this.targets.$dom&&!this.val("$dom"))&&this.val("canHaveDom")}},{key:"requiresDomRelocation",value:function(){return s.isDefined(this.val("requiresDomRelocation"))?this.val("requiresDomRelocation"):!s.isDefined(this.transformMap.x)&&!s.isDefined(this.transformMap.y)}},{key:"getBaseElement",value:function(){return this.val("baseElement")}},{key:"getOpacity",value:function(){return this.val("opacity")}},{key:"getCenterX",value:function(){return(this.getParentValue("width")-this.getWidth())/2}},{key:"getCenterY",value:function(){return(this.getParentValue("height")-this.getHeight())/2}},{key:"getX",value:function(){return this.val("x")}},{key:"getY",value:function(){return this.val("y")}},{key:"getTransformX",value:function(){var t;return this.absX-(null===(t=this.getDomParent())||void 0===t?void 0:t.absX)}},{key:"getTransformY",value:function(){var t;return this.absY-(null===(t=this.getDomParent())||void 0===t?void 0:t.absY)}},{key:"getZ",value:function(){return this.val("z")}},{key:"getPerspective",value:function(){return this.val("perspective")}},{key:"getRotate",value:function(){return this.val("rotate")}},{key:"getRotateX",value:function(){return this.val("rotateX")}},{key:"getRotateY",value:function(){return this.val("rotateY")}},{key:"getRotateZ",value:function(){return this.val("rotateZ")}},{key:"getScale",value:function(){return this.val("scale")}},{key:"getScaleX",value:function(){return this.val("scaleX")}},{key:"getScaleY",value:function(){return this.val("scaleY")}},{key:"getScaleZ",value:function(){return this.val("scaleZ")}},{key:"getSkewX",value:function(){return this.val("skewX")}},{key:"getSkewY",value:function(){return this.val("skewY")}},{key:"getSkewZ",value:function(){return this.val("skewZ")}},{key:"getMeasuringScale",value:function(){return this.val("scale")}},{key:"getZIndex",value:function(){return this.val("zIndex")}},{key:"getTopMargin",value:function(){return this.val("topMargin")}},{key:"getLeftMargin",value:function(){return this.val("leftMargin")}},{key:"getRightMargin",value:function(){return this.val("rightMargin")}},{key:"getBottomMargin",value:function(){return this.val("bottomMargin")}},{key:"getWidth",value:function(){return this.val("width")}},{key:"getHeight",value:function(){return this.val("height")}},{key:"getScrollTop",value:function(){return this.val("scrollTop")}},{key:"getScrollLeft",value:function(){return this.val("scrollLeft")}},{key:"getCss",value:function(){return this.val("css")}},{key:"getStyle",value:function(){return this.val("style")}},{key:"getBackground",value:function(){return this.val("background")}},{key:"getBackgroundColor",value:function(){return this.val("backgroundColor")}},{key:"getAttributes",value:function(){return this.val("attributes")}},{key:"getInputValue",value:function(){return this.hasDom()?this.$dom.value():void 0}},{key:"isOverflowHidden",value:function(){return"hidden"===this.val("overflow")}},{key:"reuseDomDefinition",value:function(){return this.val("reuseDomDefinition")}}])}(J);function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t){if("object"!=bt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=bt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bt(e)?e:e+""}var kt=function(){return function(t,e){return e&&Tt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.style=void 0}),[{key:"setup",value:function(){this.style={transform:this.prefixStyle("transform"),transitionTimingFunction:this.prefixStyle("transitionTimingFunction"),transitionDuration:this.prefixStyle("transitionDuration")}}},{key:"prefixStyle",value:function(t){var e=new d;e.create("div");for(var n=e.style(),r="",i=["webkitT","MozT","msT","OT","t"],a=0;a<i.length;a++)i[a]+"ransform"in n&&(r=i[a].substr(0,i[a].length-1));return""===r?t:r+t.charAt(0).toUpperCase()+t.substr(1)}}])}();function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function Et(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Mt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function Mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lt(r.key),r)}}function xt(t,e,n){return(e=Lt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lt(t){var e=function(t){if("object"!=St(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=St(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==St(e)?e:e+""}var Dt=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$document=new d(document),this.currentTouch={deltaY:0,deltaX:0,prevDeltaX:0,prevDeltaY:0,pinchDelta:0,key:"",manualMomentumFlag:!1,orientation:"none",dir:"",source:""},this.lastEvent=void 0,this.touchTimeStamp=0,this.cursor={x:0,y:0},this.start0=void 0,this.start1=void 0,this.end0=void 0,this.end1=void 0,this.touchCount=0,this.canFindHandlers=!0,this.swipeStartX=0,this.swipeStartY=0,this.currentEventName="",this.currentEventType="",this.currentEventTarget=void 0,this.currentHandlers={touch:null,scrollLeft:null,scrollTop:null,swipe:null,pinch:null,focus:null,justFocused:null,blur:null,leave:null,enter:null,start:null,end:null,hover:null},this.eventQueue=[],this.attachedEventMap={},this.eventTargetMap={},this.allEvents={},Object.values(M.events).forEach((function(t){Object.assign(e.allEvents,t)})),this.bindedHandleEvent=this.handleEvent.bind(this),this.bindedParentHandleEvent=this.handleDocEvent.bind(this)}return function(t,e){return e&&Ct(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"detachWindowEvents",value:function(){var t=this;Object.keys(M.events.windowEvents).forEach((function(e){Fe.$window.detachEvent(e,t.bindedHandleEvent)}))}},{key:"attachWindowEvents",value:function(){var t=this;Object.keys(M.events.windowEvents).forEach((function(e){Fe.$window.addEvent(e,t.bindedHandleEvent)}))}},{key:"detachDocumentEvents",value:function(){var t=this;Object.keys(M.events.documentEvents).forEach((function(e){t.$document.detachEvent(e,t.bindedParentHandleEvent)}))}},{key:"attachDocumentEvents",value:function(){var t=this;Object.keys(M.events.documentEvents).forEach((function(e){t.$document.addEvent(e,t.bindedParentHandleEvent)}))}},{key:"attachEvents",value:function(t){var e,n=Et(t);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.state().externalEventList;if((null==i?void 0:i.length)>0){var a,o=Et(i);try{for(o.s();!(a=o.n()).done;){var l=a.value;this.attachTargetEvents(r,l)}}catch(t){o.e(t)}finally{o.f()}}}}catch(t){n.e(t)}finally{n.f()}}},{key:"attachTargetEvents",value:function(t,e){var n=this,r="".concat(t.oid," ").concat(e);!t.hasDom()||this.eventTargetMap[r]&&this.eventTargetMap[r]===t.$dom||(this.eventTargetMap[r]=t.$dom,M.targetToEventsMapping[e].forEach((function(e){var r=M.events[e];Object.keys(r).forEach((function(e){var i="".concat(t.oid," ").concat(e),a=r[e].windowEvent?Fe.$window:t.$dom;a.detachEvent(e,n.bindedHandleEvent),a.addEvent(e,n.bindedHandleEvent),n.attachedEventMap[i]={$dom:a,event:e}}))})))}},{key:"detachAll",value:function(){var t=this;Object.keys(this.attachedEventMap).forEach((function(e){var n=t.attachedEventMap[e],r=n.$dom,i=n.event;r.exists()&&r.detachEvent(i,t.bindedHandleEvent)})),this.attachedEventMap={},this.eventTargetMap={}}},{key:"resetEventsOnTimeout",value:function(){if(this.currentTouch.deltaY||this.currentTouch.deltaX||this.currentTouch.pinchDelta){var t=this.touchTimeStamp-s.now();t>100&&(this.currentTouch.deltaY*=.95,this.currentTouch.deltaX*=.95,this.currentTouch.pinchDelta*=.95,Math.abs(this.currentTouch.deltaY)<.1&&(this.currentTouch.deltaY=0),Math.abs(this.currentTouch.deltaX)<.1&&(this.currentTouch.deltaX=0),Math.abs(this.currentTouch.pinchDelta)<.1&&(this.currentTouch.pinchDelta=0),0===this.currentTouch.deltaX&&0===this.currentTouch.deltaY&&0===this.currentTouch.pinchDelta&&(this.touchTimeStamp=0)),(t<=0||0===this.touchTimeStamp)&&(this.currentTouch.deltaY=0,this.currentTouch.deltaX=0,this.currentTouch.pinchDelta=0,this.touchTimeStamp=0),Je().schedule(10,"scroll decay")}}},{key:"findEventHandlers",value:function(t){var e,n,r,i,a,o,l,s,u=t.tmodel,c=t.eventType;u&&(e=ct.findFirstClickHandler(u),n=ct.findFirstSwipeHandler(u),l=ct.findFirstEnterHandler(u),s=ct.findFirstLeaveHandler(u),r=ct.findFirstScrollLeftHandler(u,c),i=ct.findFirstScrollTopHandler(u,c),a=ct.findFirstPinchHandler(u),o=d.hasFocus(u)?u:this.currentHandlers.focus),this.currentHandlers.scrollLeft===r&&this.currentHandlers.scrollTop===i||this.clearTouch(),this.currentHandlers.focus!==o&&(this.currentHandlers.justFocused=o,this.currentHandlers.blur=this.currentHandlers.focus),this.currentHandlers.start=null!=u&&u.canHandleEvent("onStart")?u:void 0,this.currentHandlers.end=null!=u&&u.canHandleEvent("onEnd")?u:void 0,this.currentHandlers.hover=null!=u&&u.canHandleEvent("onHover")?u:void 0,this.currentHandlers.click=e,this.currentHandlers.swipe=n,this.currentHandlers.scrollLeft=r,this.currentHandlers.scrollTop=i,this.currentHandlers.pinch=a,this.currentHandlers.focus=o,this.currentHandlers.enter=l,this.currentHandlers.leave=s}},{key:"captureEvents",value:function(){if(this.currentTouch.prevDeltaX=0,this.currentTouch.prevDeltaY=0,this.currentHandlers.enter=void 0,this.currentHandlers.leave=void 0,this.currentHandlers.justFocused=void 0,this.currentHandlers.blur=void 0,0===this.eventQueue.length)return this.currentEventName="",this.currentEventType="",this.currentEventTarget=void 0,void(this.currentKey="");var t=this.eventQueue.shift();this.canFindHandlers&&this.findEventHandlers(t),"end"!==t.eventType&&"click"!==t.eventType||(this.canFindHandlers=!0),this.currentEventName=t.eventName,this.currentEventType=t.eventType,this.currentEventTarget=t.eventTarget,this.currentKey=this.currentTouch.key,this.currentTouch.key=""}},{key:"handleDocEvent",value:function(t){this.handleEvent(t,!0)}},{key:"handleEvent",value:function(e,n){var r,i,a;if(e){var o=e.type,l=e.target,u=this.allEvents[o];if(u){var c,h=u.eventName,d=u.inputType,f=u.eventType,v=u.order,y=u.queue,g=u.rateLimit,p=s.now(),m=this.getTModelFromEvent(e),b={eventName:h,eventItem:u,eventType:f,originalName:o,tmodel:m,eventTarget:l,timeStamp:p};if(null!==(r=this.lastEvent)&&void 0!==r&&r.eventItem){var T=this.lastEvent,w=T.eventItem,k=p-T.timeStamp;if(d&&w.inputType&&w.inputType!==d&&v>w.order)return;if(this.eventQueue.length>t.MAX_EVENT_QUEUE_SIZE&&g>0&&k<g)for(var S=0,E=this.eventQueue.length-1;E>=0;E--){var M;if((null===(M=this.eventQueue[E].eventItem)||void 0===M?void 0:M.eventType)!==f)break;if(++S>t.MAX_EVENT_TYPE_CAPACITY)return}}switch(this.lastEvent=b,y&&this.eventQueue.push(this.lastEvent),h){case"mousedown":case"touchstart":return this.clearStart(),this.clearEnd(),this.clearTouch(),this.touchCount=this.countTouches(e)||1,this.preventDefault(m,h)&&e.cancelable&&e.preventDefault(),this.start0=this.getTouch(e),this.start1=this.getTouch(e,1),this.cursor.x=this.start0.x,this.cursor.y=this.start0.y,this.findEventHandlers(b),this.canFindHandlers=!1,this.swipeStartX=this.start0.x-(null===(i=this.currentHandlers.swipe)||void 0===i?void 0:i.getX()),this.swipeStartY=this.start0.y-(null===(a=this.currentHandlers.swipe)||void 0===a?void 0:a.getY()),e.stopPropagation(),this.detachDocumentEvents(),void this.attachDocumentEvents(m.getDomParent());case"mousemove":case"touchmove":c=this.getTouch(e),this.cursor.x=c.x,this.cursor.y=c.y,this.preventDefault(m,h)&&e.preventDefault(),this.touchCount>0?(this.touchTimeStamp=p+10,this.move(e),e.stopPropagation()):this.isCurrentSource("wheel")&&this.clearTouch();break;case"mouseup":case"touchend":this.detachDocumentEvents(),this.preventDefault(m,h)&&e.preventDefault(),c=this.getTouch(e),this.cursor.x=c.x,this.cursor.y=c.y,this.end(e),this.clearEnd(),this.touchCount=0,e.stopPropagation();break;case"click":if(this.preventDefault(m,h)&&e.preventDefault(),this.end0=this.getTouch(e),this.start0){var C=ct.findFirstClickHandler(m);C&&C===this.currentHandlers.click&&(this.eventQueue.length=0,this.eventQueue.push({eventName:h,eventItem:u,eventType:f,originalName:o,tmodel:m,eventTarget:l,timeStamp:p}))}this.clearEnd(),this.touchCount=0,e.stopPropagation();break;case"wheel":this.preventDefault(m,h)&&e.preventDefault(),this.touchTimeStamp=p+500,this.wheel(e);break;case"mouseleave":n&&this.touchCount>0&&(this.detachDocumentEvents(),c=this.getTouch(e),this.cursor.x=c.x,this.cursor.y=c.y,this.end(e),this.clearEnd(),this.touchCount=0,e.stopPropagation());break;case"key":this.currentTouch.key=e.which||e.keyCode;break;case"resize":this.resizeRoot()}Je().schedule(0,"".concat(o,"-").concat(h,"-").concat((e.target.tagName||"").toUpperCase()))}}}},{key:"resizeRoot",value:function(){H.executeDeclarativeTarget(_e(),"width"),H.executeDeclarativeTarget(_e(),"height")}},{key:"preventDefault",value:function(t,e){return!(!t||!(!0===t.preventDefault()||Array.isArray(t.preventDefault())&&t.preventDefault().includes(e)))}},{key:"getTModelFromEvent",value:function(t){var e,n=null===(e=t.target)||void 0===e?void 0:e.id;return n&&Fe.manager.visibleOidMap[n]||(n=d.findNearestParentWithId(t.target)),Fe.manager.visibleOidMap[n]}},{key:"clearStart",value:function(){this.start0=void 0,this.start1=void 0}},{key:"clearEnd",value:function(){this.end0=void 0,this.end1=void 0}},{key:"clearTouch",value:function(){this.currentTouch={deltaY:0,deltaX:0,prevDeltaX:0,prevDeltaY:0,pinchDelta:0,key:"",manualMomentumFlag:!1,orientation:"none",dir:"",source:""}}},{key:"clearAll",value:function(){this.clearStart(),this.clearEnd(),this.clearTouch(),this.eventQueue.length=0,this.touchTimeStamp=0,this.touchCount=0,this.canFindHandlers=!0,this.lastEvent=void 0,this.attachedEventMap={},this.eventTargetMap={},this.swipeStartX=0,this.swipeStartY=0}},{key:"deltaX",value:function(){return this.currentTouch.deltaX}},{key:"deltaY",value:function(){return this.currentTouch.deltaY}},{key:"cursorX",value:function(){return this.cursor.x}},{key:"cursorY",value:function(){return this.cursor.y}},{key:"swipeX",value:function(){return this.cursor.x-this.swipeStartX}},{key:"swipeY",value:function(){return this.cursor.y-this.swipeStartY}},{key:"pinchDelta",value:function(){return this.currentTouch.pinchDelta}},{key:"dir",value:function(){return this.currentTouch.dir}},{key:"getScrollLeftHandler",value:function(){return this.currentHandlers.scrollLeft}},{key:"getScrollTopHandler",value:function(){return this.currentHandlers.scrollTop}},{key:"getPinchHandler",value:function(){return this.currentHandlers.pinch}},{key:"getClickHandler",value:function(){return this.currentHandlers.click}},{key:"getTouchCount",value:function(){return this.touchCount}},{key:"isClickEvent",value:function(){return"click"===this.getEventType()}},{key:"isMoveEvent",value:function(){return"move"===this.getEventType()}},{key:"isResizeEvent",value:function(){return"resize"===this.getEventType()}},{key:"isSwipeEvent",value:function(){return this.hasDelta()&&1===this.touchCount}},{key:"isScrollEvent",value:function(){return this.hasDelta()&&this.isCurrentSource("wheel")}},{key:"hasDelta",value:function(){return 0!==this.deltaX()||0!==this.deltaY()}},{key:"isEndEvent",value:function(){return"end"===this.getEventType()||"click"===this.getEventType()}},{key:"isStartEvent",value:function(){return"start"===this.getEventType()}},{key:"getEventName",value:function(){return this.currentEventName}},{key:"getEventTarget",value:function(){return this.currentEventTarget}},{key:"getEventType",value:function(){return this.currentEventType}},{key:"isClickHandler",value:function(t){return this.getClickHandler()===t&&this.isClickEvent()}},{key:"isEnterHandler",value:function(t){return t===this.currentHandlers.enter&&"mouseenter"===this.getEventName()}},{key:"isLeaveHandler",value:function(t){return t===this.currentHandlers.leave&&"mouseleave"===this.getEventName()}},{key:"isHoverHandler",value:function(t){return t===this.currentHandlers.hover}},{key:"isSwipeHandler",value:function(t){return t===this.currentHandlers.swipe}},{key:"isStartHandler",value:function(t){return t===this.currentHandlers.start}},{key:"isEndHandler",value:function(t){return t===this.currentHandlers.end}},{key:"onFocus",value:function(t){return this.currentHandlers.justFocused===t}},{key:"onBlur",value:function(t){return this.currentHandlers.blur===t}},{key:"hasFocus",value:function(t){return this.currentHandlers.focus===t}},{key:"isScrollLeftHandler",value:function(t){return this.currentHandlers.scrollLeft===t}},{key:"isScrollTopHandler",value:function(t){return this.currentHandlers.scrollTop===t}},{key:"isPinchHandler",value:function(t){return this.currentHandlers.pinch===t}},{key:"isCurrentSource",value:function(t){return this.currentTouch.source===t}},{key:"getOrientation",value:function(){return this.currentTouch.orientation}},{key:"countTouches",value:function(t){var e,n;return(null===(e=t.touches)||void 0===e?void 0:e.length)||(null===(n=t.originalEvent)||void 0===n||null===(n=n.touches)||void 0===n?void 0:n.length)}},{key:"getTouch",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(null===(e=t.touches)||void 0===e?void 0:e[r])||(null===(n=t.originalEvent)||void 0===n||null===(n=n.touches)||void 0===n?void 0:n[r])||t,a=s.isDefined(i.clientX)?i.clientX:i.pageX||0,o=s.isDefined(i.clientY)?i.clientY:i.pageY||0;return{x:a,y:o,originalX:a,originalY:o,target:i.target,timeStamp:s.now()}}},{key:"move",value:function(t){if(1===this.touchCount){if(this.start0.y=this.end0?this.end0.y:this.start0.y,this.start0.x=this.end0?this.end0.x:this.start0.x,this.end0=this.getTouch(t),s.isDefined(this.end0)){var e=this.start0.x-this.end0.x,n=this.start0.y-this.end0.y;this.setDeltaXDeltaY(e,n,"touch")}}else if(this.touchCount>=2){this.end0=this.getTouch(t),this.end1=this.getTouch(t,1);var r=s.distance(this.start0.x,this.start0.y,this.start1.x,this.start1.y),i=s.distance(this.end0.x,this.end0.y,this.end1.x,this.end1.y)-r;this.currentTouch.pinchDelta=i>0?.3:i<0?-.3:0}}},{key:"end",value:function(){if(this.touchCount<=1&&this.start0){var t,e=0,n=0,r=0;s.isDefined(this.end0)&&(e=this.start0.originalX-this.end0.x,n=this.start0.originalY-this.end0.y,r=s.now()-this.start0.timeStamp<250?s.now()-this.start0.timeStamp:0),"horizontal"===this.currentTouch.orientation&&Math.abs(e)>0&&r>0?(t=s.momentum(0,e,r),this.touchTimeStamp=this.end0.timeStamp+t.duration,this.touchTimeStamp-s.now()>0&&(this.currentTouch.deltaX=t.distance,this.currentTouch.manualMomentumFlag=!0)):"vertical"===this.currentTouch.orientation&&Math.abs(n)>0&&r>0&&(t=s.momentum(0,n,r),this.touchTimeStamp=this.end0.timeStamp+t.duration,this.touchTimeStamp-s.now()>0&&(this.currentTouch.deltaY=t.distance,this.currentTouch.manualMomentumFlag=!0))}}},{key:"setDeltaXDeltaY",value:function(t,e,n){var r=Math.abs(t)-Math.abs(e);r>=1?("none"===this.currentTouch.orientation||"vertical"===this.currentTouch.orientation&&r>=2||"horizontal"===this.currentTouch.orientation)&&(this.currentTouch.orientation="horizontal",this.currentTouch.dir=t<=-1?"left":t>=1?"right":this.currentTouch.dir,this.currentTouch.source=n):("none"===this.currentTouch.orientation||"horizontal"===this.currentTouch.orientation&&r<=-2||"vertical"===this.currentTouch.orientation)&&(this.currentTouch.orientation="vertical",this.currentTouch.dir=e<=-1?"up":e>=1?"down":this.currentTouch.dir,this.currentTouch.source=n),this.currentTouch.prevDeltaX+=t,this.currentTouch.prevDeltaY+=e,this.currentTouch.deltaX=this.currentTouch.prevDeltaX,this.currentTouch.deltaY=this.currentTouch.prevDeltaY}},{key:"wheel",value:function(t){var e=0,n=0;this.currentTouch.pinchDelta=0,this.start0=this.getTouch(t),t.ctrlKey&&"deltaY"in t?this.currentTouch.pinchDelta=-t.deltaY/10:"deltaX"in t?(e=t.deltaX,n=t.deltaY):"wheelDeltaX"in t?(e=-t.wheelDeltaX/120,n=-t.wheelDeltaY/120):"wheelDelta"in t?e=-t.wheelDelta/120:"detail"in t&&(e=t.detail/3),this.setDeltaXDeltaY(e,n,"wheel")}}])}();function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function jt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){At(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function At(t,e,n){return(e=It(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,It(r.key),r)}}function It(t){var e=function(t){if("object"!=Pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pt(e)?e:e+""}xt(Dt,"MAX_EVENT_QUEUE_SIZE",10),xt(Dt,"MAX_EVENT_TYPE_CAPACITY",2);var Ht=function(){return function(t,e){return e&&Vt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cacheMap={},this.tmodelKeyMap={},this.fetchingAPIMap={},this.fetchingImageMap={}}),[{key:"fetchCommon",value:function(t,e,n,r,i){return p.markTargetAction(n,"fetchAction"),e&&this.isFetched(e)?r[t]||(r[t]={fetchId:t,cacheId:e,fetchingFlag:!0,startTime:s.now(),targets:[{tmodel:n,targetName:n.key}],fetchMap:r}):r[t]?r[t].targets.push({tmodel:n,targetName:n.key}):(r[t]={fetchId:t,cacheId:e,fetchingFlag:!0,startTime:s.now(),targets:[{tmodel:n,targetName:n.key}],fetchMap:r},i()),this.addToTModelKeyMap(n,n.key,t,e),t}},{key:"fetch",value:function(t,e,n,r){var i=this,a="".concat(t.oid,"_").concat(e,"_").concat(JSON.stringify(n));this.fetchCommon(a,r,t,this.fetchingAPIMap,(function(){i.ajaxAPI(e,n,i.fetchingAPIMap[a])}))}},{key:"fetchImage",value:function(t,e,n){var r=this,i="".concat(t.oid,"_").concat(e);return this.fetchCommon(i,n,t,this.fetchingImageMap,(function(){r.loadImage(e,r.fetchingImageMap[i])}))}},{key:"getTModelKey",value:function(t,e){return"".concat(document.URL," ").concat(t.oid," ").concat(e)}},{key:"getLoadTargetName",value:function(t){return"load-".concat(t)}},{key:"addToTModelKeyMap",value:function(t,e,n,r){var i=this.getTModelKey(t,e),a=this.getLoadTargetName(e);this.tmodelKeyMap[i]||(this.tmodelKeyMap[i]={fetchMap:{},entryCount:0,resultCount:0,errorCount:0,activeIndex:0,accessIndex:0},t.val(a,[])),this.tmodelKeyMap[i].fetchMap[n]||(this.tmodelKeyMap[i].fetchMap[n]={fetchId:n,order:this.tmodelKeyMap[i].entryCount},this.tmodelKeyMap[i].entryCount++,t.val(a).push(void 0)),r&&this.isFetched(r)&&this.handleSuccess(this.fetchingAPIMap[n],this.cacheMap[r].result)}},{key:"removeFromTModelKeyMap",value:function(t,e){var n=this.getTModelKey(t,e);delete this.tmodelKeyMap[n]}},{key:"isLoading",value:function(t,e){var n=this.getTModelKey(t,e);return this.tmodelKeyMap[n]}},{key:"isLoadingSuccessful",value:function(t,e){var n=this.getTModelKey(t,e);return this.tmodelKeyMap[n]&&this.tmodelKeyMap[n].resultCount===this.tmodelKeyMap[n].entryCount&&0===this.tmodelKeyMap[n].errorCount}},{key:"resetLoadingError",value:function(t,e){var n=this.getTModelKey(t,e),r=this.tmodelKeyMap[n];r&&(r.errorCount=0)}},{key:"nextActiveItem",value:function(t,e){var n=this.getTModelKey(t,e),r=this.tmodelKeyMap[n];return!!r&&r.activeIndex++}},{key:"isNextLoadingItemSuccessful",value:function(t,e){var n=this.getTModelKey(t,e),r=this.tmodelKeyMap[n];if(!r)return!1;var i=this.getLoadTargetName(e),a=t.val(i);return 0===r.errorCount&&Array.isArray(a)&&s.isDefined(a[r.activeIndex])}},{key:"getLoadingItemValue",value:function(t,e){var n=t.targets[e],r=this.getTModelKey(t,e),i=this.tmodelKeyMap[r];if(i&&n){var a,o=this.getLoadTargetName(e),l=t.val(o);return l&&("onEnd"===n.fetchAction?(a=l.slice(i.accessIndex),i.accessIndex+=a.length):(a=l[i.accessIndex],i.accessIndex++)),a}}},{key:"isFetching",value:function(t){var e,n;return null!==(e=null===(n=this.fetchingAPIMap[t])||void 0===n?void 0:n.fetchingFlag)&&void 0!==e&&e}},{key:"isFetched",value:function(t){var e,n;return null!==(e=null===(n=this.cacheMap[t])||void 0===n?void 0:n.success)&&void 0!==e&&e}},{key:"getFetchingPeriod",value:function(t){return this.fetchingAPIMap[t]?s.now()-this.fetchingAPIMap[t].startTime:void 0}},{key:"fetchCache",value:function(t){return this.cacheMap[t]}},{key:"handleSuccess",value:function(t,e){var n=this,r=s.now(),i=t.fetchId,a=t.cacheId,o=t.startTime,l=t.targets,u=t.fetchMap,c={fetchingPeriod:r-o,success:!0,result:e};l.forEach((function(t){var e=t.tmodel,r=t.targetName,a=n.getTModelKey(e,r),o=n.tmodelKeyMap[a],l=n.getLoadTargetName(r);if(o){var s=o.fetchMap[i];n.callOnSuccessHandler(e,r,jt(jt({},c),{},{order:s.order}));var u=e.val(l);u&&(u[s.order]=c.result),e.val(r,1===(null==u?void 0:u.length)?u[0]:u),o.resultCount++,0===o.errorCount&&p.shouldActivateNextTarget(e,r)}})),delete u[i],a&&(this.cacheMap[a]=c),Je().schedule(0,"api_success_".concat(i))}},{key:"handleError",value:function(t,e){var n=this,r=s.now(),i=t.fetchId,a=t.cacheId,o=t.startTime,l=t.targets,u=t.fetchMap;l.forEach((function(t){var a=t.tmodel,l=t.targetName,s="".concat(a.oid," ").concat(l),u=n.tmodelKeyMap[s],c=n.getLoadTargetName(l);if(u){var h=u.fetchMap[i],d={fetchingPeriod:r-o,success:!1,order:h.order,error:e},f=a.val(c);f[h.order]=d,a.val(l,1===f.length?f[0]:f),u.resultCount++,u.errorCount++,n.callOnErrorHandler(a,l)}})),delete u[i],a&&delete this.cacheMap[a],Je().schedule(0,"api_error_".concat(i))}},{key:"callOnSuccessHandler",value:function(t,e,n){var r,i=null===(r=t.targets[e])||void 0===r?void 0:r.onSuccess;i&&("function"==typeof i?(t.setTargetMethodName(e,"onSuccess"),i.call(t,n)):Array.isArray(i)?i.forEach((function(e){return p.activateSingleTarget(t,e)})):p.activateSingleTarget(t,i))}},{key:"callOnErrorHandler",value:function(t,e){var n,r=null===(n=t.targets[e])||void 0===n?void 0:n.onError;r&&("function"==typeof r?(t.setTargetMethodName(e,"onSuccess"),r.call(t,t.val(e))):Array.isArray(r)?r.forEach((function(e){return p.activateSingleTarget(t,e)})):p.activateSingleTarget(t,r))}},{key:"ajaxAPI",value:function(t,e,n){var r=this,i={dataType:"json",type:"GET",success:function(t){return r.handleSuccess(n,t)},error:function(t){return r.handleError(n,t)}};null!=e&&e.dataType&&(i.dataType=e.dataType,delete e.dataType),null!=e&&e.requestType&&(i.type=e.requestType,delete e.requestType),d.ajax(jt(jt({},i),{},{url:t},{data:e}))}},{key:"loadImage",value:function(t,e){var n=this,r=new Image;r.src=t,r.onload=function(){var t={width:r.width,height:r.height,src:r.src};n.handleSuccess(e,t)},r.onerror=function(){n.handleError(e,"not found")}}}])}();function Nt(t){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nt(t)}function Ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rt(r.key),r)}}function Rt(t){var e=function(t){if("object"!=Nt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nt(e)?e:e+""}function Ut(t,e,n){return e=Bt(e),function(t,e){if(e&&("object"==Nt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Yt()?Reflect.construct(e,n||[],Bt(t).constructor):e.apply(t,n))}function Yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Yt=function(){return!!t})()}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}var $t=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Ut(this,e,["BI"])).parent=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(e,t),function(t,e){return e&&Ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"canHaveDom",value:function(){return!1}},{key:"getItemOverflowMode",value:function(){return"never"}},{key:"shouldBeBracketed",value:function(){return!1}},{key:"excludeDefaultStyling",value:function(){return!0}},{key:"isIncluded",value:function(){return!1}},{key:"getWidth",value:function(){return this.getContentWidth()}},{key:"getHeight",value:function(){return this.getContentHeight()}},{key:"getBaseWidth",value:function(){return this.bottomBaseWidth}},{key:"getContainerOverflowMode",value:function(){return this.getRealParent().getContainerOverflowMode()}},{key:"getTopBaseHeight",value:function(){return this.topBaseHeight}},{key:"isVisible",value:function(){return this.getChildren().length>0&&s.isDefined(this.getChild(0).targets.isVisible)?(H.executeDeclarativeTarget(this.getChild(0),"isVisible"),this.getChild(0).isVisible()):!!this.visibilityStatus&&this.visibilityStatus.top&&this.visibilityStatus.bottom}},{key:"getBracketThreshold",value:function(){return this.getRealParent().getBracketSize()}},{key:"addToParentVisibleChildren",value:function(){}},{key:"createViewport",value:function(){return this.viewport=this.viewport||new rt,this.viewport.xNext=this.x,this.viewport.xNorth=this.x,this.viewport.xEast=this.x,this.viewport.xSouth=this.x,this.viewport.xWest=this.x,this.viewport.absX=this.getRealParent().viewport.absX,this.viewport.absY=this.getRealParent().viewport.absY,this.viewport.scrollTop=this.getRealParent().viewport.scrollTop,this.viewport.scrollLeft=this.getRealParent().viewport.scrollLeft,this.viewport.xOverflowReset=this.getRealParent().viewport.xOverflowReset,this.viewport.xOverflowLimit=this.getRealParent().viewport.xOverflowLimit,this.viewport.yNext=this.y,this.viewport.yNorth=this.y,this.viewport.yWest=this.y,this.viewport.yEast=this.y,this.viewport.ySouth=this.getRealParent().viewport.ySouth,this.viewport}},{key:"getRealParent",value:function(){return this.realParent}},{key:"calcAbsolutePosition",value:function(t,e){this.absX=t+this.getRealParent().absX,this.absY=e+this.getRealParent().absY}},{key:"shouldCalculateChildren",value:function(){var t=this.isVisible()||"new"===this.currentStatus;return this.currentStatus=void 0,t}},{key:"validateVisibilityInParent",value:function(){return this.getChildren().length>0&&this.getChild(0).validateVisibilityInParent()}},{key:"getChildren",value:function(){return this.allChildrenList}}])}(mt);function Wt(t){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wt(t)}function _t(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=qt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function qt(t,e){if(t){if("string"==typeof t)return zt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zt(t,e):void 0}}function zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gt(r.key),r)}}function Zt(t,e,n){return(e=Gt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gt(t){var e=function(t){if("object"!=Wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Wt(e)?e:e+""}var Qt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){return n&&Kt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,0,[{key:"generate",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!t.bracketMap[e.oid]||t.pageMap[e.oid]!==e.allChildrenList||n?(t.bracketMap[e.oid]=t.buildTreeBottomUp(e,e.getChildren()),t.pageMap[e.oid]=e.allChildrenList):(e.lastChildrenUpdate.deletions.length>0&&(t.updateTreeOnDeletions(e,e.lastChildrenUpdate.deletions),t.reindexTree(e)),e.lastChildrenUpdate.additions.length>0&&t.updateTreeOnAdditions(e,e.lastChildrenUpdate.additions),(e.lastChildrenUpdate.deletions.length>0||e.lastChildrenUpdate.additions.length>0)&&t.reindexTree(e)),e.lastChildrenUpdate.additions.length=0,e.lastChildrenUpdate.deletions.length=0,t.bracketMap[e.oid]}},{key:"updateTreeOnDeletions",value:function(e,n){function r(n,i){if(n)if(i instanceof $t&&i.parent===i.realParent){var a=t.bracketMap[e.oid],o=a.indexOf(i);o>=0&&a.splice(o,1)}else{var l=n.allChildrenList.indexOf(i);l>=0&&(n.allChildrenList.splice(l,1),0===n.allChildrenList.length&&r(n.parent,n))}}n.forEach((function(t){return r(t.bracket,t)}))}},{key:"reindexTree",value:function(e){function n(t,e){if(0===t.allChildrenList.length)return e;if(t.allChildrenList[0]instanceof $t){t.startIndex=e;var r,i=_t(t.allChildrenList);try{for(i.s();!(r=i.n()).done;)e=n(r.value,e)}catch(t){i.e(t)}finally{i.f()}t.endIndex=e}else t.startIndex=e,e+=t.allChildrenList.length,t.endIndex=e;return e}var r,i=0,a=_t(t.bracketMap[e.oid]);try{for(a.s();!(r=a.n()).done;)i=n(r.value,i)}catch(t){a.e(t)}finally{a.f()}}},{key:"updateTreeOnAdditions",value:function(e,n){var r=e.getBracketSize();n.forEach((function(n){var i=n.index,a=n.child,o=t.findOrCreateBracket(e,i),l=i-o.startIndex;l<o.allChildrenList.length?o.allChildrenList.splice(l,0,a):o.allChildrenList.push(a),a.bracket=o;var s=o;for(s.startIndex=Math.min(s.startIndex,i),s.endIndex=s.startIndex+s.allChildrenList.length,s.currentStatus="new",s=o.getParent();s instanceof $t;)s.startIndex=Math.min(s.startIndex,i),s.endIndex=Math.max(s.endIndex,i+1),s.currentStatus="new",s=s.getParent();o.allChildrenList.length>r&&t.splitBracket(e,o)}))}},{key:"splitBracket",value:function(e,n){for(var r=n.allChildrenList,i=e.getBracketSize(),a=[],o=n.startIndex,l=0;l<r.length;l+=i){var s=r.slice(l,l+i),u=o+s.length,c=t.createBracket(e,o,u,s);c.parent=n.parent,o=c.endIndex,a.push(c)}if(n.parent!==n.realParent){var h,d=n.parent.allChildrenList.indexOf(n);if(d>=0&&(h=n.parent.allChildrenList).splice.apply(h,[d,1].concat(a)),n.parent.allChildrenList.length>=i){var f=t.buildTreeBottomUp(e,n.parent.allChildrenList);if(n.parent.allChildrenList=f,n.parent.parent){var v,y=n.parent.parent.allChildrenList.indexOf(n.parent);y>=0&&(v=n.parent.parent.allChildrenList).splice.apply(v,[y,1].concat(function(t){return function(t){if(Array.isArray(t))return zt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||qt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(f)))}}}else{var g=t.bracketMap[e.oid],p=g.indexOf(n);p>=0&&g.splice.apply(g,[p,1].concat(a)),g.length>e.getBracketSize()&&(t.bracketMap[e.oid]=t.buildTreeBottomUp(e,g))}}},{key:"findOrCreateBracket",value:function(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.bracketMap[e.oid],a=_t(i);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.startIndex<=n&&o.endIndex>=n)return o.getFirstChild()instanceof $t?t.findOrCreateBracket(e,n,o.allChildrenList):o}}catch(t){a.e(t)}finally{a.f()}var l=t.createBracket(e,n,n);if(i.push(l),i.length>e.getBracketSize()){var s=t.buildTreeBottomUp(e,i);t.bracketMap[e.oid].brackets=s}return l}},{key:"buildTreeBottomUp",value:function(e,n){for(var r=n.length,i=e.getBracketSize(),a=[],o=function(){var r=n.slice(l,l+i),o=r[0]instanceof $t,s=o?r[0].startIndex:l,u=o?r[r.length-1].endIndex:l+r.length,c=t.createBracket(e,s,u,r);o&&r.forEach((function(t){t.parent=c})),a.push(c)},l=0;l<r;l+=i)o();return a.length>i?t.buildTreeBottomUp(e,a):a}},{key:"createBracket",value:function(e,n,r,i){var a=new $t(e);return a.realParent=e,a.allChildrenList=i||a.allChildrenList,a.startIndex=n,a.endIndex=r,a.allChildrenList.forEach((function(t){t instanceof $t?(t.realParent=e,t.parent=a):t.bracket=a})),t.all[a.oid]=a,a}}])}();function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function te(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ee(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,re(r.key),r)}}function re(t){var e=function(t){if("object"!=Jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jt(e)?e:e+""}Zt(Qt,"bracketMap",{}),Zt(Qt,"pageMap",{}),Zt(Qt,"all",{});var ie=function(){return function(t,e){return e&&ne(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.hasLocationList=[],this.hasLocationMap={},this.visibleChildrenLengthMap={},this.updatedContainerMap={},this.locationListStats=[],this.activatedList=[],this.activatedMap={}}),[{key:"clear",value:function(){this.visibleChildrenLengthMap={},this.updatedContainerMap={},this.activatedList=[],this.activatedMap={}}},{key:"calculateAll",value:function(){var t=this;this.hasLocationList.length=0,this.hasLocationMap={},this.locationListStats=[],this.startTime=s.now(),this.calculate(),Object.keys(this.visibleChildrenLengthMap).forEach((function(e){var n=t.visibleChildrenLengthMap[e],r=n.tmodel,i=n.length;!r.isVisible()||i===r.visibleChildren.length&&0!==r.visibleChildren.length||(t.runEventTargets(r,"onVisibleChildrenChange"),t.visibleChildrenLengthMap[e].length=r.visibleChildren.length)})),Object.keys(this.updatedContainerMap).forEach((function(e){var n=t.updatedContainerMap[e];n.isVisible()&&(t.runEventTargets(n,"onChildrenChange"),delete t.updatedContainerMap[e])}))}},{key:"calculate",value:function(){this.calculateContainer(Fe.tRoot)}},{key:"calculateActivated",value:function(){for(var t=this,e=0,n=function(){var n=t.activatedList[e++];Fe.targetManager.applyTargetValues(n,n.activatedTargets),n.updatingTargetList.length>0&&Fe.targetManager.setActualValues(n,n.updatingTargetList.filter((function(t){return 0===n.getTargetStep(t)}))),t.hasLocationMap[n.oid]||t.addToLocationList(n),n.activatedTargets.length=0};e<this.activatedList.length;)n();this.activatedList.length=0,this.activatedMap={}}},{key:"getChildren",value:function(t){return t.getChildren(),t.shouldBeBracketed()?Qt.generate(t):(t.lastChildrenUpdate.additions.length=0,t.lastChildrenUpdate.deletions.length=0,Qt.bracketMap[t.oid]&&(delete Qt.bracketMap[t.oid],delete Qt.pageMap[t.oid]),t.getChildren())}},{key:"calculateContainer",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.getChildren(t),i=t.createViewport();t.childrenUpdateFlag&&(t.childrenUpdateFlag=!1,t.targets.onChildrenChange&&(this.updatedContainerMap[t.oid]=t)),t.visibleChildren.length=0;var a,o=te(r);try{var l=function(){var r=a.value;if(!r)return 1;e.locationListStats.push(r.oid),i.setCurrentChild(r),i.setLocation(),r.isIncluded()&&t.manageChildTargetExecution(r,n)&&e.calculateTargets(r),("always"===t.getContainerOverflowMode()||"always"===r.getItemOverflowMode()||"auto"===t.getContainerOverflowMode()&&"auto"===r.getItemOverflowMode()&&i.isOverflow())&&(i.overflow(),i.setLocation()),r.isIncluded()&&(r.targets.onVisibleChildrenChange&&!e.visibleChildrenLengthMap[r.oid]&&(e.visibleChildrenLengthMap[r.oid]={tmodel:r,length:r.visibleChildren.length}),e.addToLocationList(r));var o=r.getCoreTargets();o&&o.forEach((function(t){!r.isTargetEnabled(t)||r.isTargetUpdating(t)||r.isTargetImperative(t)||H.executeDeclarativeTarget(r,t,r.getTargetCycle(t))})),(r.isTargetImperative("x")||r.targets.x)&&s.isDefined(r.targetValues.x)||r.val("x",r.x),(r.isTargetImperative("y")||r.targets.y)&&s.isDefined(r.targetValues.y)||r.val("y",r.y),r.calcAbsolutePosition(r.getX(),r.getY()),r.excludeDefaultStyling()||(r.addToStyleTargetList("x"),r.addToStyleTargetList("y"));var l=r.visibilityStatus,u=!!l&&l.left&&l.right&&l.top&&l.bottom,c=r.isVisible(),h=!1;s.isDefined(r.targets.isVisible)&&!s.isDefined(r.targets.onVisible)||(h=r.calcVisibility()),s.isDefined(r.targets.isVisible)&&H.executeDeclarativeTarget(r,"isVisible"),r.isNowVisible=!u&&h||!c&&r.isVisible(),r.addToParentVisibleChildren(),r.shouldCalculateChildren()&&e.calculateContainer(r,n&&!1!==t.shouldCalculateChildTargets()),!r.isTargetImperative("height")&&!s.isDefined(r.targets.height)&&!s.isDefined(r.targets.heightFromDom)&&r.getContentHeight()>0&&(r.val("height",r.getContentHeight()),r.addToStyleTargetList("height")),!r.isTargetImperative("width")&&!s.isDefined(r.targets.width)&&!s.isDefined(r.targets.widthFromDom)&&r.getContentWidth()>0&&(r.val("width",r.getContentWidth()),r.addToStyleTargetList("width")),r.isInFlow()&&(s.isNumber(r.val("appendNewLine"))?(i.appendNewLine(),t.calcContentWidthHeight()):(t.calcContentWidthHeight(),i.nextLocation()))};for(o.s();!(a=o.n()).done;)l()}catch(t){o.e(t)}finally{o.f()}t.calcContentWidthHeight();var u,c=te(r);try{for(c.s();!(u=c.n()).done;){var h=u.value;this.checkExternalEvents(h)}}catch(t){c.e(t)}finally{c.f()}}},{key:"calculateTargets",value:function(t){this.checkInternalEvents(t),Fe.targetManager.applyTargetValues(t),Fe.targetManager.setActualValues(t),t.hasDom()&&q.shouldMeasureWidthFromDom(t)&&q.setWidthFromDom(t),t.hasDom()&&q.shouldMeasureHeightFromDom(t)&&q.setHeightFromDom(t),t.isNowVisible=!1,t.hasDomNow=!1,t.targetExecutionCount++}},{key:"checkExternalEvents",value:function(t){var e=[],n=M.allEventMap,r=t.state().externalEventList;if((null==r?void 0:r.length)>0){var i,a=te(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;n[o](t)&&e.push(o)}}catch(t){a.e(t)}finally{a.f()}}this.runEventTargets(t,e)}},{key:"checkInternalEvents",value:function(t){var e=[],n=M.internalEventMap,r=t.state().internalEventList;if((null==r?void 0:r.length)>0){var i,a=te(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;n[o](t)&&e.push(o)}}catch(t){a.e(t)}finally{a.f()}}this.runEventTargets(t,e)}},{key:"runEventTargets",value:function(t,e){Array.isArray(e)||(e=[e]);var n=qe().getEventTarget();e.forEach((function(e){var r=t.targets[e];if(t.isTargetEnabled(e)){if("function"==typeof r.value){var i=r.value.call(t,n);Array.isArray(i)?i.forEach((function(e){return p.activateSingleTarget(t,e)})):"string"==typeof i&&p.activateSingleTarget(t,i)}else Array.isArray(r.value)?r.value.forEach((function(e){return p.activateSingleTarget(t,e)})):Array.isArray(r)?r.forEach((function(e){return p.activateSingleTarget(t,e)})):p.activateSingleTarget(t,r.value);p.shouldActivateNextTarget(t,e)}}))}},{key:"addToLocationList",value:function(t){this.hasLocationMap[t.oid]||(this.hasLocationList.push(t),this.hasLocationMap[t.oid]=t)}},{key:"addToActivatedList",value:function(t){this.activatedMap[t.oid]||(this.activatedList.push(t),this.activatedMap[t.oid]=t)}},{key:"isActivated",value:function(t){return this.activatedMap[t.oid]}}])}();function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(n),!0).forEach((function(e){se(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function se(t,e,n){return(e=ve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ue(){ue=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof p?e:p,o=Object.create(a.prototype),l=new P(r||[]);return i(o,"_invoke",{value:C(t,n,l)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",v="executing",y="completed",g={};function p(){}function m(){}function b(){}var T={};u(T,o,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(O([])));k&&k!==n&&r.call(k,o)&&(T=k);var S=b.prototype=p.prototype=Object.create(T);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function M(t,e){function n(i,a,o,l){var s=h(t[i],t,a);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==ae(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(s.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function C(e,n,r){var i=d;return function(a,o){if(i===v)throw Error("Generator is already running");if(i===y){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var l=r.delegate;if(l){var s=x(l,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?y:f,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=y,r.method="throw",r.arg=u.arg)}}}function x(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=h(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(ae(e)+" is not iterable")}return m.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(M.prototype),u(M.prototype,l,(function(){return this})),e.AsyncIterator=M,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new M(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},E(S),u(S,s,"Generator"),u(S,o,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return l.type="throw",l.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],l=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;D(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function ce(t){return function(t){if(Array.isArray(t))return he(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return he(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function de(t,e,n,r,i,a,o){try{var l=t[a](o),s=l.value}catch(t){return void n(t)}l.done?e(s):Promise.resolve(s).then(r,i)}function fe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ve(r.key),r)}}function ve(t){var e=function(t){if("object"!=ae(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ae(e)?e:e+""}var ye=function(){return function(t,e){return e&&fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lastLink=s.getFullLink(document.URL),this.pageCache={}}),[{key:"openPage",value:(t=ue().mark((function t(e){return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fe.stop();case 2:Fe.reset(),e=s.getFullLink(e),this.pageCache[e]?(Fe.tRoot=this.pageCache[e].tRoot,$e.oids=this.pageCache[e].oids,Fe.tRoot.$dom=new d("#tgjs-root"),Fe.tRoot.$dom.innerHTML(this.pageCache[e].html),s.initDoms(this.pageCache[e].visibleList),this.pageCache[e].visibleList.forEach((function(t){t.visibilityStatus=void 0})),Fe.manager.lists.visible=ce(this.pageCache[e].visibleList),this.lastLink=e,Fe.start()):(Fe.tRoot.hasDom()&&Fe.tRoot.$dom.innerHTML(""),Fe.tRoot=Fe.tRootFactory(),$e.oids={},Fe.pageIsEmpty=!0,this.lastLink=e,Fe.start());case 5:case"end":return t.stop()}}),t,this)})),e=function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){de(a,r,i,o,l,"next",t)}function l(t){de(a,r,i,o,l,"throw",t)}o(void 0)}))},function(t){return e.apply(this,arguments)})},{key:"openLinkFromHistory",value:function(t){t.link?(this.onPageClose(),this.openLink(t.link,!1)):t.browserUrl&&(history.replaceState({link:t.browserUrl},"",t.browserUrl),this.openPage(t.browserUrl))}},{key:"onPageClose",value:function(){Fe.resizeLastUpdate=s.now(),qe().resizeRoot(),Fe.manager.lists.visible.forEach((function(t){tn().runEventTargets(t,["onPageClose"])}))}},{key:"openLink",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t=s.getFullLink(t),this.lastLink){Fe.tRoot.$dom=new d("#tgjs-root");var n=Fe.tRoot.$dom.innerHTML();this.onPageClose(),this.pageCache[this.lastLink]={link:this.lastLink,html:n,oids:le({},$e.oids),visibleList:ce(Fe.manager.lists.visible),tRoot:Fe.tRoot}}e&&history.pushState({link:t},"",t),this.openPage(t),Je().schedule(0,"pagemanager-processOpenLink")}},{key:"updateBrowserUrl",value:function(t){window.history.state.browserUrl?history.replaceState({browserUrl:t},"",t):(Fe.tRoot.$dom=new d("#tgjs-root"),this.pageCache[document.URL]={link:document.URL,html:Fe.tRoot.$dom.innerHTML(),oids:le({},$e.oids),visibleList:ce(Fe.manager.lists.visible),tRoot:Fe.tRoot},history.pushState({browserUrl:t},"",t)),Je().schedule(0,"pagemanager-processUpdateBrowserUrl")}},{key:"back",value:function(){return history.back()}}]);var t,e}();function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function me(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach((function(e){be(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function be(t,e,n){return(e=Me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Te(t){return function(t){if(Array.isArray(t))return Se(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ke(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ke(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function ke(t,e){if(t){if("string"==typeof t)return Se(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(t,e):void 0}}function Se(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Me(r.key),r)}}function Me(t){var e=function(t){if("object"!=ge(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ge(e)?e:e+""}var Ce=function(){return function(t,e){return e&&Ee(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()}),[{key:"init",value:function(){this.lists={visible:[],rerender:[],restyle:[],reasyncStyle:[],reattach:[],relocation:[],invisibleDom:[],noDom:[],updatingTModels:[],activeTModels:[],updatingTargets:[],activeTargets:[]},this.visibleTypeMap={},this.visibleOidMap={},this.targetMethodMap={},this.noDomMap={},this.doneTargets=[]}},{key:"clear",value:function(){this.lists.visible.length=0,this.lists.rerender.length=0,this.lists.restyle.length=0,this.lists.reasyncStyle.length=0,this.lists.reattach.length=0,this.lists.relocation.length=0,this.lists.noDom.length=0,this.lists.updatingTModels.length=0,this.lists.activeTModels.length=0,this.lists.updatingTargets.length=0,this.lists.activeTargets.length=0,this.visibleTypeMap={},this.visibleOidMap={},this.targetMethodMap={},this.noDomMap={}}},{key:"analyze",value:function(){var t,e=s.list2map(this.lists.visible);this.clear();var n,r=we(tn().hasLocationList);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.getParent();if(!a||a.allChildrenMap[i.oid]){var o=i.isVisible();if(o&&(e[i.oid]=null,!i.hasDom()||i.canHaveDom()||this.lists.invisibleDom.includes(i)||this.lists.invisibleDom.push(i),this.lists.visible.push(i),this.visibleOidMap[i.oid]=i,this.visibleTypeMap[i.type]||(this.visibleTypeMap[i.type]=[]),this.visibleTypeMap[i.type].push(i)),o||i.isActivated()){var l,u,c;this.needsRerender(i),this.needsRestyle(i),this.needsReattach(i),this.needsRelocation(i);var h=i.state();(null===(l=h.updatingTargetList)||void 0===l?void 0:l.length)>0&&(this.lists.updatingTModels.push(i),this.lists.updatingTargets=[].concat(Te(this.lists.updatingTargets),Te(h.updatingTargetList))),(null===(u=h.activeTargetList)||void 0===u?void 0:u.length)>0&&(this.lists.activeTModels.push(i),this.lists.activeTargets=[].concat(Te(this.lists.activeTargets),Te(h.activeTargetList))),(null===(c=h.activeChildrenList)||void 0===c?void 0:c.length)>0&&(this.lists.activeTModels=[].concat(Te(this.lists.activeTModels),Te(h.activeChildrenList))),h.targetMethodMap&&Object.keys(h.targetMethodMap).length>0&&(this.targetMethodMap[i.oid]=me({},h.targetMethodMap),h.targetMethodMap={}),i.deactivate()}!o&&i.canDeleteDom()||!i.canHaveDom()||i.hasDom()||this.noDomMap[i.oid]||(this.lists.noDom.push(i),this.noDomMap[i.oid]=!0)}else i.hasDom()&&!this.lists.invisibleDom.includes(i)&&this.lists.invisibleDom.push(i)}}catch(t){r.e(t)}finally{r.f()}var d=Object.values(e).filter((function(t){var e;return null!==t&&t.hasDom()&&(t.canDeleteDom()||!(null!==(e=t.getParent())&&void 0!==e&&e.allChildrenMap[t.oid]))}));return(t=this.lists.invisibleDom).push.apply(t,Te(d)),this.lists.noDom.length>0?0:this.lists.reattach.length>0?1:this.lists.relocation.length>0?2:this.lists.rerender.length>0?3:this.lists.reasyncStyle.length>0?4:this.lists.invisibleDom.length>0?5:this.lists.restyle.length>0?10:-1}},{key:"needsRelocation",value:function(t){return!(!t.hasDom()||!s.isDefined(t.domOrderIndex)||(this.lists.relocation.push(t),0))}},{key:"needsRerender",value:function(t){return!(!t.hasDom()||!s.isDefined(t.getHtml())||t.$dom.html()===t.getHtml()&&t.$dom.textOnly===t.isTextOnly()||(this.lists.rerender.push(t),0))}},{key:"needsRestyle",value:function(t){t.hasDom()&&(t.styleTargetList.length>0&&this.lists.restyle.push(t),t.asyncStyleTargetList.length>0&&this.lists.reasyncStyle.push(t))}},{key:"needsReattach",value:function(t){t.hasDom()&&!t.reuseDomDefinition()&&(t.hasDomHolderChanged()||t.hasBaseElementChanged())&&this.lists.reattach.push(t)}},{key:"renderTModels",value:function(){var t,e=we(this.lists.rerender);try{for(e.s();!(t=e.n()).done;){var n,r,i=t.value;i.isTextOnly()?null===(n=i.$dom)||void 0===n||n.text(i.getHtml()):null===(r=i.$dom)||void 0===r||r.html(i.getHtml()),i.setActualValueLastUpdate("html"),i.domHeightTimestamp=0,i.domWidthTimestamp=0}}catch(t){e.e(t)}finally{e.f()}}},{key:"reattachTModels",value:function(){var t,e=we(this.lists.reattach);try{for(e.s();!(t=e.n()).done;){var n,r=t.value;null===(n=r.$dom)||void 0===n||n.detach(),r.hasBaseElementChanged()&&q.createDom(r),r.getDomHolder(r)&&r.getDomHolder(r).appendTModel$Dom(r)}}catch(t){e.e(t)}finally{e.f()}}},{key:"relocateTModels",value:function(){this.lists.relocation.sort((function(t,e){return e.domOrderIndex-t.domOrderIndex}));var t,e=we(this.lists.relocation);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.getDomParent().$dom.relocate(n,n.domOrderIndex),n.domOrderIndex=void 0}}catch(t){e.e(t)}finally{e.f()}}},{key:"deleteDoms",value:function(){var t,e=we(this.lists.invisibleDom);try{for(e.s();!(t=e.n()).done;){var n,r=t.value;r.styleMap={},r.transformMap={},r.val("isVisible",!1),r.hasDomNow=!1,null===(n=r.$dom)||void 0===n||n.detach(),r.$dom=null}}catch(t){e.e(t)}finally{e.f()}this.lists.invisibleDom.length=0}},{key:"fixStyles",value:function(){var t,e=we(this.lists.restyle);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hasDom()&&q.fixStyle(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"fixAsyncStyles",value:function(){var t,e=we(this.lists.reasyncStyle);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.hasDom()&&q.fixAsyncStyle(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"completeDoneTModels",value:function(){this.doneTargets.forEach((function(t){var e=t.tmodel,n=t.key;e.isTargetDone(n)&&(e.setTargetComplete(n),e.removeFromActiveTargets(n),e.removeFromUpdatingTargets(n))}))}},{key:"createDoms",value:function(){if(0!==this.lists.noDom.length){var t=[];this.lists.noDom.sort((function(t,e){return t.getUIDepth()<e.getUIDepth()?-1:1}));var e,n=we(this.lists.noDom);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=void 0;d.query("#".concat(r.oid))?(i=new d("#".concat(r.oid)),r.$dom=i,r.hasDomNow=!0,this.needsRestyle(r)):t.push(r)}}catch(t){n.e(t)}finally{n.f()}for(var a=0,o=t;a<o.length;a++){var l,s=o[a];null!==(l=s.getDomHolder(s))&&void 0!==l&&l.exists()&&(s.val("$dom")?s.$dom=s.val("$dom"):(s.$dom=new d,q.createDom(s)),s.getDomHolder(s).appendTModel$Dom(s),s.hasDomNow=!0)}qe().attachEvents(this.lists.noDom)}}}])}();function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Le(){Le=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof p?e:p,o=Object.create(a.prototype),l=new P(r||[]);return i(o,"_invoke",{value:C(t,n,l)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",v="executing",y="completed",g={};function p(){}function m(){}function b(){}var T={};u(T,o,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(O([])));k&&k!==n&&r.call(k,o)&&(T=k);var S=b.prototype=p.prototype=Object.create(T);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function M(t,e){function n(i,a,o,l){var s=h(t[i],t,a);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==xe(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(s.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function C(e,n,r){var i=d;return function(a,o){if(i===v)throw Error("Generator is already running");if(i===y){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var l=r.delegate;if(l){var s=x(l,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?y:f,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=y,r.method="throw",r.arg=u.arg)}}}function x(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=h(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(xe(e)+" is not iterable")}return m.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(M.prototype),u(M.prototype,l,(function(){return this})),e.AsyncIterator=M,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new M(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},E(S),u(S,s,"Generator"),u(S,o,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return l.type="throw",l.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],l=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;D(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function De(t,e,n,r,i,a,o){try{var l=t[a](o),s=l.value}catch(t){return void n(t)}l.done?e(s):Promise.resolve(s).then(r,i)}function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Oe(r.key),r)}}function Oe(t){var e=function(t){if("object"!=xe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xe(e)?e:e+""}var je=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nextRuns=[],this.domProcessing=0,this.runningFlag=!1,this.runId="",this.runStartTime=void 0,this.rerunId="",this.delayProcess=void 0,this.resetting=!1,this.activeStartTime=void 0}return function(t,e){return e&&Pe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"resetRuns",value:(e=Le().mark((function t(){var e;return Le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.resetting=!0,t.next=3,new Promise((function(t){return requestAnimationFrame(t)}));case 3:null!==(e=this.delayProcess)&&void 0!==e&&e.timeoutId&&clearTimeout(this.delayProcess.timeoutId),this.nextRuns=[],this.domProcessing=0,this.runningFlag=!1,this.runId="",this.runStartTime=void 0,this.rerunId="",this.delayProcess=void 0,this.resetting=!1,this.activeStartTime=void 0;case 13:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(t){De(a,r,i,o,l,"next",t)}function l(t){De(a,r,i,o,l,"throw",t)}o(void 0)}))},function(){return n.apply(this,arguments)})},{key:"schedule",value:function(t,e){!Fe.isRunning()||this.resetting||0===t&&this.rerunId||(0===t&&0===Fe.throttle?this.run(t,e):this.delayRun(0===Fe.throttle?t||0:Fe.throttle,e))}},{key:"run",value:function(t,e){if(Fe.isRunning()&&!this.resetting)if(this.runningFlag)this.rerunId||(this.rerunId="rerun ".concat(e));else{this.rerunId="",this.runId=e,this.runningFlag=!0,this.runStartTime=s.now(),qe().captureEvents(),Qe().doneTargets.length>0&&(Qe().completeDoneTModels(),Qe().doneTargets.length=0),Fe.targetManager.applyTargetValues(Fe.tRoot),tn().calculateAll(),tn().calculateActivated(),Fe.events.resetEventsOnTimeout();var n,r=Fe.manager.analyze();r>=0&&(0===this.domProcessing?this.domOperations(r):this.rerunId||(this.rerunId="domrun ".concat(e))),1===Fe.debugLevel&&s.log(!0)("Request from: ".concat(e," delay: ").concat(t," runningStep:").concat(r," dom:").concat(this.domProcessing," runs:").concat(this.nextRuns.length," D:").concat(null===(n=this.delayProcess)||void 0===n?void 0:n.delay)),0===this.domProcessing&&this.needsRerun()}}},{key:"needsRerun",value:function(){if(this.runningFlag=!1,this.rerunId)this.schedule(1,"rerun-".concat(this.rerunId));else{var t=this.nextRuns.length>0?this.nextRuns[0].delay-(s.now()-this.nextRuns[0].insertTime):void 0;if(void 0===t){if(qe().eventQueue.length>0)this.schedule(15,"events-".concat(qe().eventQueue.length));else if(Qe().lists.updatingTModels.length>0)this.schedule(15,"getManager-needsRerun-updatingTModels");else if(Qe().lists.activeTModels.length>0){var e=Qe().lists.activeTModels.find((function(t){return 0===t.targetExecutionCount||t.activeTargetList.some((function(e){return t.shouldScheduleRun(e)}))}));if(e){var n=!this.activeStartTime||s.now()-this.activeStartTime>15?1:15;this.activeStartTime=s.now(),this.schedule(n,"getManager-needsRerun-".concat(e.oid,"-").concat(e.activeTargetList))}}}else t<0&&t>=-15&&this.executeNextRun()}}},{key:"domOperations",value:function(e){var n=this;this.domProcessing=1,10===e?this.domFixStyles():Promise.all(t.domSteps.filter((function(t,n){return n>=e})).map((function(t){return Promise.resolve().then(t)}))).then((function(){Qe().lists.restyle.length?n.domFixStyles():(n.domProcessing=0,n.needsRerun())}))}},{key:"domFixStyles",value:function(){var t=this;this.domProcessing=2,requestAnimationFrame((function(){Qe().fixStyles(),t.domProcessing=0,t.needsRerun()}))}},{key:"setDelayProcess",value:function(t,e,n,r){var i=this;r>0?this.delayProcess={runId:t,insertTime:e,runTime:n,delay:r,timeoutId:setTimeout((function(){i.run(r,t),i.executeNextRun()}),r)}:(this.delayProcess={runId:t,insertTime:e,runTime:n,delay:0},this.run(r,t),this.executeNextRun())}},{key:"executeNextRun",value:function(){for(var t=null,e=null;this.nextRuns.length>0;){var n=this.nextRuns.shift(),r=s.now();if(!(n.delay-(r-n.insertTime)<0)){e=n;break}t=n}if(t)this.setDelayProcess(t.runId,t.insertTime,s.now(),0);else if(e){var i=s.now(),a=Math.max(1,e.delay-(i-e.insertTime));this.setDelayProcess(e.runId,e.insertTime,i+a,a)}else this.delayProcess=void 0}},{key:"delayRun",value:function(t,e){var n=this.runStartTime,r=n+t;this.delayProcess?this.delayProcess.timeoutId&&r<this.delayProcess.runTime?(clearTimeout(this.delayProcess.timeoutId),this.insertRun(this.delayProcess.runId,this.delayProcess.insertTime,this.delayProcess.delay),this.setDelayProcess(e,n,r,t)):this.insertRun(e,n,t):this.setDelayProcess(e,n,r,t)}},{key:"insertRun",value:function(t,e,n){for(var r=0,i=this.nextRuns.length;r<i;){var a=Math.floor((r+i)/2),o=this.nextRuns[a].delay,l=this.nextRuns[a].insertTime+o-(e+n);if(l>0)i=a;else{if(!(l<0))return;r=a+1}}this.nextRuns.splice(r,0,{runId:t,insertTime:e,delay:n})}}]);var e,n}();function Ae(t){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(t)}function Ve(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ie(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ie(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){l=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw a}}}}function Ie(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function He(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ne(r.key),r)}}function Ne(t){var e=function(t){if("object"!=Ae(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ae(e)?e:e+""}!function(t,e,n){(e=Oe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(je,"domSteps",[function(){return Qe().createDoms()},function(){return Qe().reattachTModels()},function(){return Qe().relocateTModels()},function(){return Qe().renderTModels()},function(){return Qe().fixAsyncStyles()},function(){Qe().lists.invisibleDom.length>0&&Qe().deleteDoms()}]);var Fe,Re=function(){return function(t,e){return e&&He(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}),[{key:"applyTargetValues",value:function(t){var e,n=Ve(arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.activeTargetList.slice(0));try{for(n.s();!(e=n.n()).done;){var r=e.value;t.isTargetImperative(r)||this.applyTargetValue(t,r)}}catch(t){n.e(t)}finally{n.f()}}},{key:"applyTargetValue",value:function(t,e){var n=t.targets[e];if(s.isDefined(n)){if(!t.isExecuted(e)||!t.hasUpdatingTargets(e)){if(t.isExecuted(e)&&t.getTargetStep(e)===t.getTargetSteps(e)){if(t.isScheduledPending(e)&&Je().nextRuns.length>0)return;var r=p.scheduleExecution(t,e);if(r>0)return void Je().schedule(r,"targetSchedule__".concat(t.oid,"__").concat(e,"_").concat(r))}if(t.isTargetEnabled(e))if(t.resetScheduleTimeStamp(e),t.shouldExecuteCyclesInParallel(e)){var i;i=t.isExecuted(e)?t.getTargetCycles(e):"function"==typeof n.cycles?n.cycles.call(t,0):n.cycles||0;for(var a=[],o=function(n){a.push(new Promise((function(r){H.executeDeclarativeTarget(t,e,n),r()})))},l=0;l<=i;l++)o(l);Promise.all(a).then((function(){t.targetValues[e].cycle=i,t.updateTargetStatus(e),t.shouldScheduleRun(e)&&Je().schedule(t.getTargetInterval(e),"targetSchedule__".concat(t.oid,"__").concat(e,"_rerun"))}))}else t.isExecuted(e)&&t.getTargetCycles(e)>0&&(t.getTargetCycle(e)<t.getTargetCycles(e)?t.incrementTargetCycle(e,t.getTargetCycle(e)):t.resetTargetCycle(e),t.resetTargetStep(e),t.resetTargetInitialValue(e)),H.executeDeclarativeTarget(t,e);else n.needsReactivation&&t.removeFromActiveTargets(e)}}else t.removeFromActiveTargets(e)}},{key:"setActualValues",value:function(t){var e,n=0,r=Ve(arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.updatingTargetList.slice(0));try{for(r.s();!(e=r.n()).done;){var i=e.value,a=t.getScheduleTimeStamp(i),o=t.getTargetInterval(i);if(a&&a+o>s.now()){var l=Je().nextRuns.length>0?Je().nextRuns[0]:void 0;if(l&&l.delay+l.insertTime<a+o)continue}(n=p.scheduleExecution(t,i))>0?Je().schedule(n,"setActualValues-".concat(t.oid,"__").concat(i,"_").concat(n)):(t.resetScheduleTimeStamp(i),this.setActualValue(t,i))}}catch(t){r.e(t)}finally{r.f()}}},{key:"findOriginalTModel",value:function(t,e){return ct.findParentByTarget(t,e)||an().find((function(t){return t.targets[e]}))}},{key:"setActualValue",value:function(t,e){var n=t.targetValues[e];if(n)if(t.isTargetImperative(e)||t.isTargetEnabled(e)){var r,i,a,o=t.getTargetValue(e),l=t.getTargetStep(e),u=t.getTargetSteps(e),c=t.getTargetCycle(e),h=t.getTargetInterval(e),d=t.val(e),f=l,v=c,y=t.getTargetInitialValue(e),g=s.capitalizeFirstLetter(e),m=t.getActualValueLastUpdate(e),b=s.now();if(l<=u&&(s.isDefined(y)||(y=s.isDefined(t.val(e))?t.val(e):"number"==typeof o?0:void 0,t.setTargetInitialValue(e,y)),t.val(e,q.morph(t,e,y,o,l,u)),t.addToStyleTargetList(e),t.setActualValueLastUpdate(e),t.setTargetMethodName(e,"value"),t.isTargetImperative(e)?(r=n.originalTargetName,a=t,(i=t.targets[n.originalTargetName])||(i=(a=this.findOriginalTModel(t,r))?a.targets[n.originalTargetName]:null),i&&"function"==typeof i["on".concat(g,"Step")]?(i["on".concat(g,"Step")].call(a,a.val(e),o,l,u),a.setTargetMethodName(r,["on".concat(g,"Step")])):i&&"function"==typeof i.onImperativeStep&&(i.onImperativeStep.call(a,e,a.val(e),o,l,u),a.setTargetMethodName(r,"onImperativeStep"))):p.handleValueChange(t,e,t.val(e),d,f,v),t.incrementTargetStep(e,b,m,h,u),t.updateTargetStatus(e),t.getTargetStep(e)<u))return p.shouldActivateNextTarget(t,e),void Je().schedule(h,"".concat(t.oid,"---").concat(e,"-").concat(l,"/").concat(u,"-").concat(c,"-").concat(h));t.val(e,o),t.addToStyleTargetList(e),t.setActualValueLastUpdate(e),l=t.getTargetStep(e);var T=0;n.valueList&&c<n.valueList.length-1?(t.incrementTargetCycle(e,t.getTargetCycle(e)),c=t.getTargetCycle(e),t.resetTargetStep(e),n.initialValue=n.value,n.value=n.valueList[c],n.steps=n.stepList[(c-1)%n.stepList.length],n.interval=n.intervalList[(c-1)%n.intervalList.length],n.easing=n.easingList[(c-1)%n.easingList.length],T=h):t.isTargetImperative(e)?(r=n.originalTargetName,a=t,(i=t.targets[n.originalTargetName])||(i=(a=this.findOriginalTModel(t,r))?a.targets[n.originalTargetName]:null),i&&"function"==typeof i["on".concat(g,"Step")]?(i["on".concat(g,"Step")].call(a,a.val(e),o,l,u),a.setTargetMethodName(r,["on".concat(g,"Step")])):i&&"function"==typeof i.onImperativeStep&&(i.onImperativeStep.call(a,e,a.val(e),o,l,u),a.setTargetMethodName(r,"onImperativeStep")),i&&"function"==typeof i["on".concat(g,"End")]?(i["on".concat(g,"End")].call(a,a.val(e),o,l,u),a.setTargetMethodName(r,["on".concat(g,"End")])):i&&"function"==typeof i.onImperativeEnd&&(i.onImperativeEnd.call(a,e,a.val(e)),a.setTargetMethodName(r,"onImperativeEnd"))):(!n.valueList&&t.getTargetCycle(e)<t.getTargetCycles(e)&&(t.incrementTargetCycle(e,t.getTargetCycle(e)),t.resetTargetStep(e).resetTargetInitialValue(e).resetTargetExecutionFlag(e),H.executeDeclarativeTarget(t,e)),"object"===Ae(t.targets[e])&&"function"==typeof t.targets[e].onStepsEnd&&(t.targets[e].onStepsEnd.call(t,c),t.setTargetMethodName(e,"onStepsEnd"))),t.updateTargetStatus(e),p.hasTargetEnded(t,e)&&p.shouldActivateNextTarget(t,e),Je().schedule(T,"".concat(t.oid,"---").concat(e,"-").concat(l,"/").concat(u,"-").concat(c,"-").concat(T))}else Je().schedule(10,"setActualValue-disabled-".concat(t.oid,"__").concat(e))}}])}();function Ue(t){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ue(t)}function Ye(){Ye=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof p?e:p,o=Object.create(a.prototype),l=new P(r||[]);return i(o,"_invoke",{value:C(t,n,l)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",v="executing",y="completed",g={};function p(){}function m(){}function b(){}var T={};u(T,o,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(O([])));k&&k!==n&&r.call(k,o)&&(T=k);var S=b.prototype=p.prototype=Object.create(T);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function M(t,e){function n(i,a,o,l){var s=h(t[i],t,a);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==Ue(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,l)}),(function(t){n("throw",t,o,l)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,l)}))}l(s.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function C(e,n,r){var i=d;return function(a,o){if(i===v)throw Error("Generator is already running");if(i===y){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var l=r.delegate;if(l){var s=x(l,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=v;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?y:f,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=y,r.method="throw",r.arg=u.arg)}}}function x(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=h(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Ue(e)+" is not iterable")}return m.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(M.prototype),u(M.prototype,l,(function(){return this})),e.AsyncIterator=M,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new M(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},E(S),u(S,s,"Generator"),u(S,o,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return l.type="throw",l.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],l=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;D(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function Be(t,e,n,r,i,a,o){try{var l=t[a](o),s=l.value}catch(t){return void n(t)}l.done?e(s):Promise.resolve(s).then(r,i)}function Xe(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){Be(a,r,i,o,l,"next",t)}function l(t){Be(a,r,i,o,l,"throw",t)}o(void 0)}))}}var $e=function(t){var e,n;e=t,n={throttle:0,debugLevel:0,runningFlag:!1,resizeLastUpdate:0,pageIsEmpty:!1,init:function(){return n.browser=new kt,n.browser.setup(),n.$window=new d(window),n.$window.addEvent("popstate",(function(t){t.state&&Fe.pager.openLinkFromHistory(t.state)})),n.loader=new Ht,n.pager=new ye,n.events=new Dt,n.locationManager=new ie,n.targetManager=new Re,n.manager=new Ce,n.runScheduler=new je,n.tRootFactory=function(){var t=new mt("tRoot",{start:function(){d.query("#tgjs-root")?this.$dom=new d("#tgjs-root"):(this.$dom=new d,this.$dom.create("div"),this.$dom.setSelector("#tgjs-root"),this.$dom.setId("#tgjs-root"),this.$dom.attr("tabindex","0"),new d("body").insertFirst$Dom(this.$dom))},styling:!1,domHolder:function(){return this.$dom},isVisible:!0,width:function(){var e=d.getScreenWidth();return e!==t.val("width")&&(n.resizeLastUpdate=s.now()),e},height:function(){var e=d.getScreenHeight();return e!==t.val("height")&&(n.resizeLastUpdate=s.now()),e}});return t.oids={},t.val("width",d.getScreenWidth()),t.val("height",d.getScreenHeight()),n.tRoot&&n.tRoot.getChildren().forEach((function(e){var n=new mt(e.type,e.targets);t.addChild(n)})),t},n.tRoot=n.tRootFactory(),e&&n.tRoot.addChild(e),window.history.pushState({link:document.URL},"",document.URL),n}},n.start=Xe(Ye().mark((function t(){return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.runningFlag=!1,H.executeDeclarativeTarget(n.tRoot,"width"),H.executeDeclarativeTarget(n.tRoot,"height"),n.events.detachAll(),n.events.detachWindowEvents(),n.events.attachWindowEvents(),n.events.clearAll(),n.events.attachEvents(n.manager.lists.visible),t.next=10,n.runScheduler.resetRuns();case 10:return n.runningFlag=!0,n.runScheduler.schedule(0,"appStart"),t.abrupt("return",n);case 13:case"end":return t.stop()}}),t)}))),n.stop=Xe(Ye().mark((function t(){return Ye().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.runningFlag=!1,n.events.detachAll(),n.events.detachWindowEvents(),n.events.clearAll(),t.next=6,n.runScheduler.resetRuns();case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)}))),n.reset=function(){n.manager.lists.visible.forEach((function(t){t.transformMap={},t.styleMap={},t.allStyleTargetList.forEach((function(e){s.isDefined(t.val(e))&&t.addToStyleTargetList(e)}))})),n.manager.clear(),n.locationManager.clear(),ct.clear()},n.isRunning=function(){return n.runningFlag},n.find=function(t){return ct.find(t)},(Fe=n).init().start()};$e.oids={},$e.getOid=function(t){var e=$e.oids;s.isDefined(e[t])||(e[t]=0);var n=e[t]++;return{oid:n>0||t.endsWith("_")?"".concat(t).concat(n):t,num:n}};var We=function(){return!!Fe&&Fe.runningFlag},_e=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.tRoot},qe=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.events},ze=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.pager},Ke=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.loader},Ze=function(t,e,n,r){var i;return null===(i=Fe)||void 0===i||null===(i=i.loader)||void 0===i?void 0:i.fetch(t,e,n,r)},Ge=function(t,e,n){var r;return null===(r=Fe)||void 0===r||null===(r=r.loader)||void 0===r?void 0:r.fetchImage(t,e,n)},Qe=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.manager},Je=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.runScheduler},tn=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.locationManager},en=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.browser},nn=function(){var t,e;return null!==(t=null===(e=Fe)||void 0===e||null===(e=e.tRoot)||void 0===e?void 0:e.getWidth())&&void 0!==t?t:0},rn=function(){var t,e;return null!==(t=null===(e=Fe)||void 0===e||null===(e=e.tRoot)||void 0===e?void 0:e.getHeight())&&void 0!==t?t:0},an=function(){var t;return null===(t=Fe)||void 0===t||null===(t=t.manager)||void 0===t?void 0:t.lists.visible},on=function(){var t;return null===(t=Fe)||void 0===t?void 0:t.resizeLastUpdate};function ln(t){return ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ln(t)}function sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,un(r.key),r)}}function un(t){var e=function(t){if("object"!=ln(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ln(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ln(e)?e:e+""}window.t=window.t||ct.find;var cn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,n){return n&&sn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,0,[{key:"bounce",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.yStart,i=void 0===r?void 0:r,a=n.xStart,o=void 0===a?nn()/2:a,l=n.widthStart,u=void 0===l?50:l,c=n.heightStart,h=void 0===c?50:c,d=n.bFactor,f=void 0===d?.6:d,v=n.cFactor,y=void 0===v?.2:v,g=n.rotationStart,p=void 0===g?0:g,m=n.rIncrement,b=void 0===m?360:m,T=Math.max(10,(e-t)*f),w=s.isDefined(i)?[i,t]:[t],k=[o],S=[u],E=[h],M=[p];Math.abs(0|T)>1;){w.push(e),w.push(e-T);var C=u*(1+y),x=h*(1-y);S.push(C),S.push(u),E.push(x),E.push(h),k.push(o-(C-u)/2),k.push(o),M.push(M[M.length-1]+b),T*=f,b*=.8,y*=f}k.push(o),w.push(e),S.push(u),E.push(h);var L=M[M.length-1]%360;return L>0&&L<360&&M.push(360),{x:{list:k},y:{list:w},width:{list:S},height:{list:E},rotate:{list:M}}}},{key:"bounceSimple",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.from,i=void 0===r?void 0:r,a=n.to,o=void 0===a?void 0:a,l=n.widthStart,u=void 0===l?void 0:l,c=n.heightStart,h=void 0===c?void 0:c,d=n.xStart,f=void 0===d?void 0:d,v=n.yStart,y=void 0===v?void 0:v,g=n.bFactor,p=void 0===g?.7:g,m=n.cFactor,b=void 0===m?.2:m;return i=s.isDefined(i)?i:e.getY(),o=s.isDefined(o)?o:e.getY(),u=s.isDefined(u)?u:e.getWidth(),h=s.isDefined(h)?h:e.getHeight(),y=s.isDefined(y)?y:e.getY(),f=s.isDefined(f)?f:e.getX(),t.bounce(i,o,{yStart:y,xStart:f,widthStart:u,heightStart:h,bFactor:p,cFactor:b,rIncrement:0})}},{key:"shake",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.bFactor,i=void 0===r?.6:r,a=n.cFactor,o=void 0===a?.3:a,l=n.strength,s=void 0===l?20:l;if(!t.shakeMap[e.oid]){var u=(e.getParentValue("width")-e.getWidth())/2,c=e.getY(),h=e.getWidth(),d=e.getHeight();t.shakeMap[e.oid]={xStart:u,yStart:c,widthStart:h,heightStart:d}}var f=t.shakeMap[e.oid],v=f.xStart,y=f.yStart,g=f.widthStart,p=f.heightStart,m=t.bounce(y-s,y,{xStart:v,widthStart:g,heightStart:p,bFactor:i,cFactor:o});return{y:{list:m.height.list.map((function(t){return y-(t-p)/2}))},x:m.x,width:m.width,height:m.height}}},{key:"spiral",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.startAngle,n=void 0===e?0:e,r=t.endAngle,i=void 0===r?360:r,a=t.angleStep,o=void 0===a?18:a,l=t.x,s=void 0===l?0:l,u=t.y,c=void 0===u?0:u,h=t.width,d=void 0===h?100:h,f=t.height,v=void 0===f?100:f,y=[],g=[],p=[],m=n;m<=i;m+=o){var b=m*(Math.PI/180);y.push(Math.floor(s+d*Math.cos(b))),g.push(Math.floor(c+v*Math.sin(b))),p.push(90+m)}return{x:{list:y},y:{list:g},rotate:{list:p}}}}])}();!function(t,e,n){(e=un(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(cn,"shakeMap",{}),window.TargetJS=e}();